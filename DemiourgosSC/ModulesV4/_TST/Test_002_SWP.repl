(print "")
(print "===================Initialise Ouronet_TX-002============================")
(begin-tx "INIT TX 000 - Chain Data Time SetUp Definition")
(namespace "free")
(env-chain-data
    {"prev-block-hash": "98c486052a5147fdd30fa43cc6d67e0a4e680c856c37f9157cb788cd67d58006",
     "block-time": TV.TIME00}
)
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-gas)
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(print "=============================================BEGIN SWP TESTS==========================================")
(begin-tx "SWP TX 001 - Make 10k DWK")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs
    [   
        { "key": "6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263", 
          "caps": [
                    (coin.TRANSFER 
                    "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                    "c:fQ9KNZrn8rBUW7wWYoQ2SENoBiqDTCuH9mOd_6Ggdz4"
                    20000.0)
                  ]
        }
    ]
)

(let
    (
        (ref-TS01-C2:module{TalosStageOne_ClientTwo} TS01-C2)
    )
    (ref-TS01-C2::LQD|C_WrapKadena KST.ANHD KST.ANHD 20000.0)
)
(print "")
(print "")
(format "<<<<<<<STEP 001 WrapKadena Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(begin-tx "SWP TX 002 - Coil 5k DLK")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AncientHodler", "caps": [] }
    ]
)

(let
    (
        (ref-DALOS:module{OuronetDalosV2} DALOS)
        (ref-DPTF:module{DemiourgosPactTrueFungibleV2} DPTF)
        (ref-DPMF:module{DemiourgosPactMetaFungibleV2} DPMF)
        (ref-TS01-C2:module{TalosStageOne_ClientTwo} TS01-C2)

        (dwk-id:string (ref-DALOS::UR_WrappedKadenaID))
        (dlk-id:string (ref-DALOS::UR_LiquidKadenaID))
        (ats-pairs-with-dlk-id:[string] (ref-DPTF::UR_RewardBearingToken dlk-id))
        (kdaliquindex:string (at 0 ats-pairs-with-dlk-id))
    )
    (ref-TS01-C2::ATS|C_Coil
        KST.ANHD
        KST.ANHD
        kdaliquindex
        dwk-id
        10000.0
    )
    [
        (format "AH has {} DWK" [(ref-DPTF::UR_AccountSupply (ref-DALOS::UR_WrappedKadenaID) KST.ANHD)])
        (format "AH has {} DLK" [(ref-DPTF::UR_AccountSupply (ref-DALOS::UR_LiquidKadenaID) KST.ANHD)])
        (format "AH has {} GAS" [(ref-DPTF::UR_AccountSupply (ref-DALOS::UR_IgnisID) KST.ANHD)])
        (format "AH Elite is {}" [(ref-DALOS::UR_Elite KST.ANHD)])
        (format "AH Elite Auryn is {}" [(ref-DPTF::UR_AccountSupply (ref-DALOS::UR_EliteAurynID) KST.ANHD)])
        (format "AH Vested Elite Auryn is {}" [(ref-DPMF::UR_AccountSupply (ref-DPTF::UR_Vesting (ref-DALOS::UR_EliteAurynID)) KST.ANHD)])
    ]
    
)
(print "")
(print "")
(format "<<<<<<<STEP 002 Coil DWK Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(print "=================================AOZ-SECTION============================================")
(begin-tx "SWP TX 03 - Move 50k OURO from ANHD to AOZ")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AncientHodler", "caps": [] }
    ]
)

(let
    (
        (ref-TS01-C1:module{TalosStageOne_ClientOne} TS01-C1)
    )
    (ref-TS01-C1::DPTF|C_Transfer 
        KST.ANHD
        "OURO-98c486052a51"
        KST.ANHD
        KST.AOZT
        50000.0
        false
    )
)
    
(print "")
(print "")
(format "<<<<<<<STEP 003 Transfer 50k OURO Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(begin-tx "SWP TX 04 - Issue W|DLK-98c486052a51|OURO-98c486052a51|DWK-98c486052a51")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(let
    (
        (ref-DALOS:module{OuronetDalosV2} DALOS)
        (ref-SWP:module{SwapperV2} SWP)
        (ref-TS01-C2:module{TalosStageOne_ClientTwo} TS01-C2)
        (split-kda:[decimal] 
            (ref-DALOS::URC_SplitKDAPrices
                KST.ANHD
                (+ (ref-DALOS::UR_UsagePrice "dptf") (ref-DALOS::UR_UsagePrice "swp"))
            )
        )
    )
    (env-sigs
        [   
            { "key": "PK_AncientHodler", "caps": [] }
            { "key": "6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" , 
              "caps": 
                [
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "k:50d6c59b21e5e6e55baecaa75a1007de37576bde12d8230dc82459cc01b9484b"
                        (at 2 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "k:0cb30c0121ff919266121a99ff9359871818932211df94dae4137c29bc0e8f7e"
                        (at 0 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "c:Y_iaJ6fE-ic7kwTtLfty66e3zyGGYIX7OdiMrIdkYBg"
                        (at 3 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "c:HVNhO-WfROlC-guMUNk91MJWPzfSiP1O7Ip4T4g93O0"
                        (at 1 split-kda)
                    )
                ] 
            }
        ]
    )
    (let
        (
            (pool
                (ref-TS01-C2::SWP|C_IssueWeighted
                    KST.ANHD
                    KST.ANHD
                    [
                        { "token-id":  (ref-DALOS::UR_LiquidKadenaID), "token-supply": 3200.0}
                        { "token-id":  (ref-DALOS::UR_OuroborosID), "token-supply": 10000.0}
                        { "token-id":  (ref-DALOS::UR_WrappedKadenaID), "token-supply": 6000.0}
                    ]
                    5.0
                    [0.2 0.5 0.3]
                    true
                )
            )
        )
        (print "")
        (print "")
        (format "<<<<<<<Issue Data is {} >>>>>>>" [pool])
    )
)
(print "")
(print "")
(format "<<<<<<<STEP 004 Issue W|DLK-98c486052a51|OURO-98c486052a51|DWK-98c486052a51 Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(begin-tx "SWP TX 05 - Issue S|DLK-98c486052a51|OURO-98c486052a51|DWK-98c486052a51")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(let
    (
        (ref-DALOS:module{OuronetDalosV2} DALOS)
        (ref-SWP:module{SwapperV2} SWP)
        (ref-TS01-C2:module{TalosStageOne_ClientTwo} TS01-C2)
        (split-kda:[decimal] 
            (ref-DALOS::URC_SplitKDAPrices
                KST.ANHD
                (+ (ref-DALOS::UR_UsagePrice "dptf") (ref-DALOS::UR_UsagePrice "swp"))
            )
        )
    )
    (env-sigs
        [   
            { "key": "PK_AncientHodler", "caps": [] }
            { "key": "6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" , 
              "caps": 
                [
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "k:50d6c59b21e5e6e55baecaa75a1007de37576bde12d8230dc82459cc01b9484b"
                        (at 2 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "k:0cb30c0121ff919266121a99ff9359871818932211df94dae4137c29bc0e8f7e"
                        (at 0 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "c:Y_iaJ6fE-ic7kwTtLfty66e3zyGGYIX7OdiMrIdkYBg"
                        (at 3 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "c:HVNhO-WfROlC-guMUNk91MJWPzfSiP1O7Ip4T4g93O0"
                        (at 1 split-kda)
                    )
                ] 
            }
        ]
    )
    (let
        (
            (ref-U|SWP:module{UtilitySwp} U|SWP)
            (ref-SWPU:module{SwapperUsageV2} SWPU)
            (t1:string (ref-DALOS::UR_LiquidKadenaID))
            (t2:string (ref-DALOS::UR_OuroborosID))
            (t3:string (ref-DALOS::UR_WrappedKadenaID))
            (t1a:decimal 800.0)
            (t2a:decimal 900.0)
            (t3a:decimal 850.0)
            (pool
                (ref-TS01-C2::SWP|C_IssueStable
                    KST.ANHD
                    KST.ANHD
                    [
                        { "token-id":  t1, "token-supply": t1a}
                        { "token-id":  t2, "token-supply": t2a}
                        { "token-id":  t3, "token-supply": t3a}
                    ]
                    10.0
                    85.0
                    false
                )
            )
        )
        (print "")
        (print "")
        (format "<<<<<<<Issue Data is {} >>>>>>>" [pool])
    )
)
(print "")
(print "")
(format "<<<<<<<STEP 005 Issue S|DLK-98c486052a51|OURO-98c486052a51|DWK-98c486052a51 Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(begin-tx "SWP TX 06 - Issue P|OURO-98c486052a51|PKOSON-98c486052a51")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AOZ", "caps": [] }
    ]
)
(let
    (
        (ref-DALOS:module{OuronetDalosV2} DALOS)
        (ref-SWP:module{SwapperV2} SWP)
        (ref-TS01-C2:module{TalosStageOne_ClientTwo} TS01-C2)
        (split-kda:[decimal] 
            (ref-DALOS::URC_SplitKDAPrices
                KST.AOZT
                (+ (ref-DALOS::UR_UsagePrice "dptf") (ref-DALOS::UR_UsagePrice "swp"))
            )
        )
    )
    (env-sigs
        [   
            { "key": "PK_AOZ", "caps": [] }
            { "key": "95a59029029524ebb250b2fafe6826ff88bb59c527d661cba3279d09a51d3bdf" , 
              "caps": 
                [
                    (coin.TRANSFER 
                        "k:95a59029029524ebb250b2fafe6826ff88bb59c527d661cba3279d09a51d3bdf" 
                        "k:50d6c59b21e5e6e55baecaa75a1007de37576bde12d8230dc82459cc01b9484b"
                        (at 2 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:95a59029029524ebb250b2fafe6826ff88bb59c527d661cba3279d09a51d3bdf" 
                        "k:0cb30c0121ff919266121a99ff9359871818932211df94dae4137c29bc0e8f7e"
                        (at 0 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:95a59029029524ebb250b2fafe6826ff88bb59c527d661cba3279d09a51d3bdf" 
                        "c:Y_iaJ6fE-ic7kwTtLfty66e3zyGGYIX7OdiMrIdkYBg"
                        (at 3 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:95a59029029524ebb250b2fafe6826ff88bb59c527d661cba3279d09a51d3bdf" 
                        "c:HVNhO-WfROlC-guMUNk91MJWPzfSiP1O7Ip4T4g93O0"
                        (at 1 split-kda)
                    )
                ] 
            }
        ]
    )
    (let
        (
            (pool
                (ref-TS01-C2::SWP|C_IssueStandard
                    KST.AOZT
                    KST.AOZT
                    [
                        { "token-id":  "OURO-98c486052a51", "token-supply": 2500.0}
                        { "token-id":  "PKOSON-98c486052a51", "token-supply": 10000.0}
                    ]
                    25.0
                    false
                )
            )
        )
        (print "")
        (print "")
        (format "<<<<<<<Issue Data is {} >>>>>>>" [pool])
    )
)
(print "")
(print "")
(format "<<<<<<<STEP 006 Issue P|OURO-98c486052a51|PKOSON-98c486052a51 Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(begin-tx "SWP TX 07 - Issue S|PKOSON-98c486052a51|EKOSON-98c486052a51|AKOSON-98c486052a51")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AOZ", "caps": [] }
    ]
)
(let
    (
        (ref-DALOS:module{OuronetDalosV2} DALOS)
        (ref-SWP:module{SwapperV2} SWP)
        (ref-TS01-C2:module{TalosStageOne_ClientTwo} TS01-C2)
        (split-kda:[decimal] 
            (ref-DALOS::URC_SplitKDAPrices
                KST.AOZT
                (+ (ref-DALOS::UR_UsagePrice "dptf") (ref-DALOS::UR_UsagePrice "swp"))
            )
        )
    )
    (env-sigs
        [   
            { "key": "PK_AOZ", "caps": [] }
            { "key": "95a59029029524ebb250b2fafe6826ff88bb59c527d661cba3279d09a51d3bdf" , 
              "caps": 
                [
                    (coin.TRANSFER 
                        "k:95a59029029524ebb250b2fafe6826ff88bb59c527d661cba3279d09a51d3bdf" 
                        "k:50d6c59b21e5e6e55baecaa75a1007de37576bde12d8230dc82459cc01b9484b"
                        (at 2 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:95a59029029524ebb250b2fafe6826ff88bb59c527d661cba3279d09a51d3bdf" 
                        "k:0cb30c0121ff919266121a99ff9359871818932211df94dae4137c29bc0e8f7e"
                        (at 0 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:95a59029029524ebb250b2fafe6826ff88bb59c527d661cba3279d09a51d3bdf" 
                        "c:Y_iaJ6fE-ic7kwTtLfty66e3zyGGYIX7OdiMrIdkYBg"
                        (at 3 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:95a59029029524ebb250b2fafe6826ff88bb59c527d661cba3279d09a51d3bdf" 
                        "c:HVNhO-WfROlC-guMUNk91MJWPzfSiP1O7Ip4T4g93O0"
                        (at 1 split-kda)
                    )
                ] 
            }
        ]
    )
    (let
        (
            (pool
                (ref-TS01-C2::SWP|C_IssueStable
                    KST.AOZT
                    KST.AOZT
                    [
                        { "token-id":  "PKOSON-98c486052a51", "token-supply": 10000.0}
                        { "token-id":  "EKOSON-98c486052a51", "token-supply": 10000.0}
                        { "token-id":  "AKOSON-98c486052a51", "token-supply": 10000.0}
                    ]
                    5.0
                    85.0
                    false
                )
            )
        )
        (print "")
        (print "")
        (format "<<<<<<<Issue Data is {} >>>>>>>" [pool])
    )
)

(print "")
(print "")
(format "<<<<<<<STEP 007 Issue S|PKOSON-98c486052a51|EKOSON-98c486052a51|AKOSON-98c486052a51 Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(begin-tx "SWP TX 08 - Issue P|OURO-98c486052a51|BUSD-98c486052a51")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AncientHodler", "caps": [] }
    ]
)
(let
    (
        (ref-DALOS:module{OuronetDalosV2} DALOS)
        ;(ref-SWP:module{SwapperV2} SWP)
        (ref-TS01-C2:module{TalosStageOne_ClientTwo} TS01-C2)
        (split-kda:[decimal] 
            (ref-DALOS::URC_SplitKDAPrices
                KST.ANHD
                (+ (ref-DALOS::UR_UsagePrice "dptf") (ref-DALOS::UR_UsagePrice "swp"))
            )
        )
    )
    (env-sigs
        [   
            { "key": "PK_AncientHodler", "caps": [] }
            { "key": "6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" , 
              "caps": 
                [
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "k:50d6c59b21e5e6e55baecaa75a1007de37576bde12d8230dc82459cc01b9484b"
                        (at 2 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "k:0cb30c0121ff919266121a99ff9359871818932211df94dae4137c29bc0e8f7e"
                        (at 0 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "c:Y_iaJ6fE-ic7kwTtLfty66e3zyGGYIX7OdiMrIdkYBg"
                        (at 3 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "c:HVNhO-WfROlC-guMUNk91MJWPzfSiP1O7Ip4T4g93O0"
                        (at 1 split-kda)
                    )
                ] 
            }
        ]
    )
    (let
        (
            (pool
                (ref-TS01-C2::SWP|C_IssueStandard
                    KST.ANHD
                    KST.ANHD
                    [
                        { "token-id":  "OURO-98c486052a51", "token-supply": 2500.0}
                        { "token-id":  "BUSD-98c486052a51", "token-supply": 10000.0}
                    ]
                    25.0
                    false
                )
            )
        )
        (print "")
        (print "")
        (format "<<<<<<<Issue Data is {} >>>>>>>" [pool])
    )
)
(print "")
(print "")
(format "<<<<<<<STEP 008 Issue P|OURO-98c486052a51|BUSD-98c486052a51 Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(print "=======================Swap Tests=================================")
(begin-tx "SWP TX 08a - Mint 100 mil VST Origin")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AncientHodler", "caps": [] }
    ]
)

(let
    (
        (ref-TS01-C1:module{TalosStageOne_ClientOne} TS01-C1)
        (vst:string "VST-98c486052a51")
        (patron:string KST.ANHD)
    )
    ;;Mint 100 mil VST
    (ref-TS01-C1::DPTF|C_Mint patron vst patron 200000000.0 true)
)

(print "")
(print "")
(format "<<<<<<<STEP 08a Origin MInt VST costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(begin-tx "SWP TX 08b - Issue P|OURO-98c486052a51|VST-98c486052a51")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AncientHodler", "caps": [] }
    ]
)
(let
    (
        (ref-DALOS:module{OuronetDalosV2} DALOS)
        (ref-SWP:module{SwapperV2} SWP)
        (ref-TS01-C2:module{TalosStageOne_ClientTwo} TS01-C2)
        (split-kda:[decimal] 
            (ref-DALOS::URC_SplitKDAPrices
                KST.ANHD
                (+ (ref-DALOS::UR_UsagePrice "dptf") (ref-DALOS::UR_UsagePrice "swp"))
            )
        )
    )
    (env-sigs
        [   
            { "key": "PK_AncientHodler", "caps": [] }
            { "key": "6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" , 
              "caps": 
                [
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "k:50d6c59b21e5e6e55baecaa75a1007de37576bde12d8230dc82459cc01b9484b"
                        (at 2 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "k:0cb30c0121ff919266121a99ff9359871818932211df94dae4137c29bc0e8f7e"
                        (at 0 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "c:Y_iaJ6fE-ic7kwTtLfty66e3zyGGYIX7OdiMrIdkYBg"
                        (at 3 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "c:HVNhO-WfROlC-guMUNk91MJWPzfSiP1O7Ip4T4g93O0"
                        (at 1 split-kda)
                    )
                ] 
            }
        ]
    )
    (let
        (
            (pool
                (ref-TS01-C2::SWP|C_IssueStandard
                    KST.ANHD
                    KST.ANHD
                    [
                        { "token-id":  "OURO-98c486052a51", "token-supply": 2500.0}
                        { "token-id":  "VST-98c486052a51", "token-supply": 50000000.0}
                    ]
                    25.0
                    false
                )
            )
        )
        (print "")
        (print "")
        (format "<<<<<<<Issue Data is {} >>>>>>>" [pool])
    )
)
(print "")
(print "")
(format "<<<<<<<STEP 008b Issue P|OURO-98c486052a51|VST-98c486052a51 Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(begin-tx "SWP TX 09a - Issue Stable 7xUSD via defpact 0|2")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs
    [   
        { "key": "PK_AncientHodler", "caps": [] }
    ]
)

(let
    (
        (ref-DALOS:module{OuronetDalosV2} DALOS)
        (ref-DPTF:module{DemiourgosPactTrueFungibleV2} DPTF)
        (ref-TS01-CP:module{TalosStageOne_ClientPacts} TS01-CP)
        (patron:string KST.ANHD)
        (pool-tokens:[object{Swapper.PoolTokens}]
            [
                ;{ "token-id":  "OURO-98c486052a51", "token-supply": 1000.0}
                { "token-id":  "BUSD-98c486052a51", "token-supply": 1000000.0}
                { "token-id":  "TUSD-98c486052a51", "token-supply": 1000000.0}
                { "token-id":  "USDT-98c486052a51", "token-supply": 1000000.0}
                { "token-id":  "USDC-98c486052a51", "token-supply": 1000000.0}
                { "token-id":  "USDD-98c486052a51", "token-supply": 1000000.0}
                { "token-id":  "AUSD-98c486052a51", "token-supply": 1000000.0}
                { "token-id":  "CUSD-98c486052a51", "token-supply": 1000000.0}
            ]
        )
        (fee-lp:decimal 10.0)
        (weights:[decimal] (make-list (length pool-tokens) 1.0))
        (w-weigths:[decimal] [0.1 0.1 0.1 0.1 0.2 0.2 0.2 ])
        (amp:decimal 85.0)
        (p:bool false)
    )
    (ref-TS01-CP::SWP|C_IssueStableMultiStep
        patron
        patron
        pool-tokens
        fee-lp
        amp
        p
    )
    ;(ref-TS01-CP::SWP|C_IssueStandardMultiStep
    ;    patron
    ;    patron
    ;    pool-tokens
    ;    fee-lp
    ;    ;amp
    ;    p
    ;)
    ;(ref-TS01-CP::SWP|C_IssueWeightedMultiStep
    ;    patron
    ;    patron
    ;    pool-tokens
    ;    fee-lp
    ;    w-weigths
    ;    p
    ;)
    [
        (format "AH has {} GAS" [(ref-DPTF::UR_AccountSupply (ref-DALOS::UR_IgnisID) KST.ANHD)])
        (pact-state)
    ]
)

(print "")
(print "")
(format "<<<<<<<STEP 009a Issue Stable 7xUSD STEP 0|2 Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(begin-tx "SWP TX 09a - Issue Stable 7xUSD via defpact 1|2")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)

(let
    (
        (ref-DALOS:module{OuronetDalosV2} DALOS)
        (split-kda:[decimal] 
            (ref-DALOS::URC_SplitKDAPrices
                KST.ANHD
                (+ (ref-DALOS::UR_UsagePrice "dptf") (ref-DALOS::UR_UsagePrice "swp"))
            )
        )
    )
    (env-sigs
        [   
            { "key": "PK_AncientHodler", "caps": [] }
            { "key": "6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" , 
              "caps": 
                [
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "k:50d6c59b21e5e6e55baecaa75a1007de37576bde12d8230dc82459cc01b9484b"
                        (at 2 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "k:0cb30c0121ff919266121a99ff9359871818932211df94dae4137c29bc0e8f7e"
                        (at 0 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "c:Y_iaJ6fE-ic7kwTtLfty66e3zyGGYIX7OdiMrIdkYBg"
                        (at 3 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "c:HVNhO-WfROlC-guMUNk91MJWPzfSiP1O7Ip4T4g93O0"
                        (at 1 split-kda)
                    )
                ] 
            }
        ]
    )
    (continue-pact 1 false "DldRwCblQ7Loqy6wYJnaodHl30d3j3eH-qtFzfEv46g")
)

(print "")
(print "")
(format "<<<<<<<STEP 009a Issue Stable 7xUSD STEP 1|2 Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(begin-tx "SWP TX 09a - Issue Stable 7xUSD via defpact 2|2")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(namespace "free")
(env-sigs
    [   
        { "key": "PK_AncientHodler", "caps": [] }
    ]
)

(continue-pact 2 false "DldRwCblQ7Loqy6wYJnaodHl30d3j3eH-qtFzfEv46g")

(print "")
(print "")
(format "<<<<<<<STEP 009a Issue Stable 7xUSD STEP 2|2 Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(begin-tx "SWP TX 10 - Issue W|OURO-98c486052a51|TEUR-98c486052a51|EURT-98c486052a51|EURC-98c486052a51|EURD-98c486052a51|AEUR-98c486052a51|CEUR-98c486052a51")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(let
    (
        (ref-DALOS:module{OuronetDalosV2} DALOS)
        (ref-SWP:module{SwapperV2} SWP)
        (ref-TS01-C2:module{TalosStageOne_ClientTwo} TS01-C2)
        (split-kda:[decimal] 
            (ref-DALOS::URC_SplitKDAPrices
                KST.ANHD
                (+ (ref-DALOS::UR_UsagePrice "dptf") (ref-DALOS::UR_UsagePrice "swp"))
            )
        )
    )
    (env-sigs
        [   
            { "key": "PK_AncientHodler", "caps": [] }
            { "key": "6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" , 
              "caps": 
                [
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "k:50d6c59b21e5e6e55baecaa75a1007de37576bde12d8230dc82459cc01b9484b"
                        (at 2 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "k:0cb30c0121ff919266121a99ff9359871818932211df94dae4137c29bc0e8f7e"
                        (at 0 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "c:Y_iaJ6fE-ic7kwTtLfty66e3zyGGYIX7OdiMrIdkYBg"
                        (at 3 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "c:HVNhO-WfROlC-guMUNk91MJWPzfSiP1O7Ip4T4g93O0"
                        (at 1 split-kda)
                    )
                ] 
            }
        ]
    )
    (let
        (
            (pool
                (ref-TS01-C2::SWP|C_IssueWeighted
                    KST.ANHD
                    KST.ANHD
                    [
                        { "token-id":  "OURO-98c486052a51", "token-supply": 1000000.0}
                        { "token-id":  "TEUR-98c486052a51", "token-supply": 1000000.0}
                        { "token-id":  "EURT-98c486052a51", "token-supply": 1000000.0}
                        { "token-id":  "EURC-98c486052a51", "token-supply": 1000000.0}
                        { "token-id":  "EURD-98c486052a51", "token-supply": 1000000.0}
                        { "token-id":  "AEUR-98c486052a51", "token-supply": 1000000.0}
                        { "token-id":  "CEUR-98c486052a51", "token-supply": 1000000.0}
                    ]
                    5.0
                    [0.1429 0.1429 0.1429 0.1429 0.1428 0.1428 0.1428]
                    true
                )
            )
        )
        (print "")
        (print "")
        (format "<<<<<<<Issue Data is {} >>>>>>>" [pool])
    )
)
(print "")
(print "")
(format "<<<<<<<STEP 010 Issue W|OURO-98c486052a51|TEUR-98c486052a51|EURT-98c486052a51|EURC-98c486052a51|EURD-98c486052a51|AEUR-98c486052a51|CEUR-98c486052a51 Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
;;Issued Pools
;;
;;      W|DLK-98c486052a51|OURO-98c486052a51|DWK-98c486052a51
;;      S|DLK-98c486052a51|OURO-98c486052a51|DWK-98c486052a51
;;      P|OURO-98c486052a51|PKOSON-98c486052a51
;;      S|PKOSON-98c486052a51|EKOSON-98c486052a51|AKOSON-98c486052a51
;;      P|OURO-98c486052a51|BUSD-98c486052a51
;;      S|BUSD-98c486052a51|TUSD-98c486052a51|USDT-98c486052a51|USDC-98c486052a51|USDD-98c486052a51|AUSD-98c486052a51|CUSD-98c486052a51
;;      W|OURO-98c486052a51|TEUR-98c486052a51|EURT-98c486052a51|EURC-98c486052a51|EURD-98c486052a51|AEUR-98c486052a51|CEUR-98c486052a51
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(begin-tx "SWP TX 11 - Enable DLK|OURO|DWK Pools Functionality")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AncientHodler", "caps": [] }
        { "key": "PK_AOZ", "caps": [] }
    ]
)
(let
    (
        (ref-TS01-C2:module{TalosStageOne_ClientTwo} TS01-C2)
        (pool1:string "W|DLK-98c486052a51|OURO-98c486052a51|DWK-98c486052a51")
        (pool2:string "S|DLK-98c486052a51|OURO-98c486052a51|DWK-98c486052a51")
        (pool3:string "P|OURO-98c486052a51|PKOSON-98c486052a51")
        (pool4:string "S|PKOSON-98c486052a51|EKOSON-98c486052a51|AKOSON-98c486052a51")
        (pool5:string "P|OURO-98c486052a51|BUSD-98c486052a51")
        (pool6:string "P|OURO-98c486052a51|VST-98c486052a51")

        (pool7:string "S|BUSD-98c486052a51|TUSD-98c486052a51|USDT-98c486052a51|USDC-98c486052a51|USDD-98c486052a51|AUSD-98c486052a51|CUSD-98c486052a51")
        ;(pool7:string "P|OURO-98c486052a51|TUSD-98c486052a51|USDT-98c486052a51|USDC-98c486052a51|USDD-98c486052a51|AUSD-98c486052a51|CUSD-98c486052a51")
        ;(pool7:string "W|OURO-98c486052a51|TUSD-98c486052a51|USDT-98c486052a51|USDC-98c486052a51|USDD-98c486052a51|AUSD-98c486052a51|CUSD-98c486052a51")

        (pool8:string "W|OURO-98c486052a51|TEUR-98c486052a51|EURT-98c486052a51|EURC-98c486052a51|EURD-98c486052a51|AEUR-98c486052a51|CEUR-98c486052a51")
        (spt1:[object{Swapper.FeeSplit}]
            [
                {"target":KST.BYTA, "value":15}
                ;{"target":KST.LUMY, "value":125}
                ;{"target":KST.COCA, "value":35}
                ;{"target":KST.KISS, "value":35}
                ;{"target":KST.PLCS, "value":50}
                ;{"target":KST.NANI, "value":60}
                ;{"target":KST.AOZT, "value":10}
            ]
        )
        (spt2:[object{Swapper.FeeSplit}]
            [
                {"target":KST.BYTA, "value":15}
                {"target":KST.LUMY, "value":125}
                {"target":KST.COCA, "value":35}
                {"target":KST.KISS, "value":35}
                ;{"target":KST.PLCS, "value":50}
                ;{"target":KST.NANI, "value":60}
                ;{"target":KST.AOZT, "value":10}
            ]
        )
    )
    ;;Add Special Fee
    (ref-TS01-C2::SWP|C_UpdateFee KST.ANHD pool1 20.0 false)
    (ref-TS01-C2::SWP|C_UpdateFee KST.ANHD pool2 20.0 false)
    (ref-TS01-C2::SWP|C_UpdateFee KST.ANHD pool3 20.0 false)
    (ref-TS01-C2::SWP|C_UpdateFee KST.ANHD pool4 20.0 false)
    (ref-TS01-C2::SWP|C_UpdateFee KST.ANHD pool5 20.0 false)
    (ref-TS01-C2::SWP|C_UpdateFee KST.ANHD pool6 20.0 false)
    (ref-TS01-C2::SWP|C_UpdateFee KST.ANHD pool7 20.0 false)
    (ref-TS01-C2::SWP|C_UpdateFee KST.ANHD pool8 20.0 false)
    ;;Add Fee Targets
    (ref-TS01-C2::SWP|C_UpdateSpecialFeeTargets KST.ANHD pool1 spt2)
    (ref-TS01-C2::SWP|C_UpdateSpecialFeeTargets KST.ANHD pool2 spt2)
    (ref-TS01-C2::SWP|C_UpdateSpecialFeeTargets KST.ANHD pool3 spt1)
    (ref-TS01-C2::SWP|C_UpdateSpecialFeeTargets KST.ANHD pool4 spt1)
    (ref-TS01-C2::SWP|C_UpdateSpecialFeeTargets KST.ANHD pool5 spt2)
    (ref-TS01-C2::SWP|C_UpdateSpecialFeeTargets KST.ANHD pool6 spt2)
    (ref-TS01-C2::SWP|C_UpdateSpecialFeeTargets KST.ANHD pool7 spt2)
    (ref-TS01-C2::SWP|C_UpdateSpecialFeeTargets KST.ANHD pool8 spt2)
    ;;Toggle Add Liquidity
    (ref-TS01-C2::SWP|C_ToggleAddLiquidity KST.ANHD pool1 true)
    (ref-TS01-C2::SWP|C_ToggleAddLiquidity KST.ANHD pool2 true)
    (ref-TS01-C2::SWP|C_ToggleAddLiquidity KST.ANHD pool3 true)
    (ref-TS01-C2::SWP|C_ToggleAddLiquidity KST.ANHD pool4 true)
    (ref-TS01-C2::SWP|C_ToggleAddLiquidity KST.ANHD pool5 true)
    (ref-TS01-C2::SWP|C_ToggleAddLiquidity KST.ANHD pool6 true)
    (ref-TS01-C2::SWP|C_ToggleAddLiquidity KST.ANHD pool7 true)
    (ref-TS01-C2::SWP|C_ToggleAddLiquidity KST.ANHD pool8 true)
    ;;Toggle Swap Functionality
    (ref-TS01-C2::SWP|C_ToggleSwapCapability KST.ANHD pool1 true)
    (ref-TS01-C2::SWP|C_ToggleSwapCapability KST.ANHD pool2 true)
    (ref-TS01-C2::SWP|C_ToggleSwapCapability KST.ANHD pool3 true)
    (ref-TS01-C2::SWP|C_ToggleSwapCapability KST.ANHD pool4 true)
    (ref-TS01-C2::SWP|C_ToggleSwapCapability KST.ANHD pool5 true)
    (ref-TS01-C2::SWP|C_ToggleSwapCapability KST.ANHD pool6 true)
    (ref-TS01-C2::SWP|C_ToggleSwapCapability KST.ANHD pool7 true)
    (ref-TS01-C2::SWP|C_ToggleSwapCapability KST.ANHD pool8 true)
)

(print "")
(print "")
(format "<<<<<<<STEP 011 Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(print "=======================Swap Tests=================================")
(begin-tx "SWP TX 11 - 1st SWAP")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AncientHodler", "caps": [] }
    ]
)

(let
    (
        (ref-SWPU:module{SwapperUsageV2} SWPU)
        (patron:string KST.ANHD)
        (pool1:string "W|DLK-98c486052a51|OURO-98c486052a51|DWK-98c486052a51")
        (pool2:string "S|DLK-98c486052a51|OURO-98c486052a51|DWK-98c486052a51")
        (pool3:string "P|OURO-98c486052a51|PKOSON-98c486052a51")
        (pool4:string "S|PKOSON-98c486052a51|EKOSON-98c486052a51|AKOSON-98c486052a51")
        (pool5:string "P|OURO-98c486052a51|BUSD-98c486052a51")
        (pool6:string "P|OURO-98c486052a51|VST-98c486052a51")

        (pool7:string "S|BUSD-98c486052a51|TUSD-98c486052a51|USDT-98c486052a51|USDC-98c486052a51|USDD-98c486052a51|AUSD-98c486052a51|CUSD-98c486052a51")
        ;(pool7:string "P|OURO-98c486052a51|TUSD-98c486052a51|USDT-98c486052a51|USDC-98c486052a51|USDD-98c486052a51|AUSD-98c486052a51|CUSD-98c486052a51")
        ;(pool7:string "W|OURO-98c486052a51|TUSD-98c486052a51|USDT-98c486052a51|USDC-98c486052a51|USDD-98c486052a51|AUSD-98c486052a51|CUSD-98c486052a51")

        (pool8:string "W|OURO-98c486052a51|TEUR-98c486052a51|EURT-98c486052a51|EURC-98c486052a51|EURD-98c486052a51|AEUR-98c486052a51|CEUR-98c486052a51")

        (pool:string pool8)
        (input-ids:[string]
            ["TEUR-98c486052a51" "EURT-98c486052a51" "EURC-98c486052a51" "EURD-98c486052a51" "AEUR-98c486052a51" "CEUR-98c486052a51"]
        )
        (input-amounts:[decimal]
            [230.0 240.0 232.0 223.0 455.0 432.0]
        )

        (input-ids-s:[string]
            ["EURT-98c486052a51"]
        )
        (input-amounts-s:[decimal]
            [2400.0]
        )

        (output-id:string "OURO-98c486052a51")
        (slippage-value:decimal 5.0)
        (slippage-obj:object{SwapperUsage.Slippage}
            (ref-SWPU::SPWS|UDC_SlippageObject pool input-ids input-amounts output-id slippage-value)
        )

        (slippage-obj-s:object{SwapperUsage.Slippage}
            (ref-SWPU::SPWS|UDC_SlippageObject pool input-ids-s input-amounts-s output-id slippage-value)
        )
    )
    [
        (format "Slippage-Obj is {}" [slippage-obj])
        (format "Min-Max is {}" [(ref-SWPU::SWPS|UC_SlippageMinMax slippage-obj)])

        (format "Slippage-Obj Simple is {}" [slippage-obj-s])
        (format "Min-Max Simple is {}" [(ref-SWPU::SWPS|UC_SlippageMinMax slippage-obj-s)])
    ]
)

(print "")
(print "")
(format "<<<<<<<STEP 011 Swap Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(print "=======================Swap Tests=================================")
(begin-tx "SWP TX 11b - ONLY SWAP")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AncientHodler", "caps": [] }
    ]
)

(let
    (
        (ref-TS01-C2:module{TalosStageOne_ClientTwo} TS01-C2)
    )
    ;;134k
    (ref-TS01-C2::SWP|C_MultiSwap
        KST.ANHD 
        KST.ANHD
        "W|OURO-98c486052a51|TEUR-98c486052a51|EURT-98c486052a51|EURC-98c486052a51|EURD-98c486052a51|AEUR-98c486052a51|CEUR-98c486052a51"
        ["TEUR-98c486052a51" "EURT-98c486052a51" "EURC-98c486052a51" "EURD-98c486052a51" "AEUR-98c486052a51" "CEUR-98c486052a51"]
        [230.0 240.0 232.0 223.0 455.0 432.0]
        "OURO-98c486052a51"
        {"expected-output-amount": 1809.280886324937455356121064,"output-precision": 24,"slippage-percent": 5.0}
    )
    ;;129k
    (ref-TS01-C2::SWP|C_MultiSwapNoSlippage
        KST.ANHD 
        KST.ANHD
        "W|OURO-98c486052a51|TEUR-98c486052a51|EURT-98c486052a51|EURC-98c486052a51|EURD-98c486052a51|AEUR-98c486052a51|CEUR-98c486052a51"
        ["TEUR-98c486052a51" "EURT-98c486052a51" "EURC-98c486052a51" "EURD-98c486052a51" "AEUR-98c486052a51" "CEUR-98c486052a51"]
        [230.0 240.0 232.0 223.0 455.0 432.0]
        "OURO-98c486052a51"
        ;{"expected-output-amount": 1809.280886324937455356121064,"output-precision": 24,"slippage-percent": 5.0}
    )

    ;84k
    (ref-TS01-C2::SWP|C_SimpleSwap
        KST.ANHD 
        KST.ANHD
        "W|OURO-98c486052a51|TEUR-98c486052a51|EURT-98c486052a51|EURC-98c486052a51|EURD-98c486052a51|AEUR-98c486052a51|CEUR-98c486052a51"
        "EURT-98c486052a51"
        2400.0
        "OURO-98c486052a51"
        {"expected-output-amount": 2394.253790901391766965389252,"output-precision": 24,"slippage-percent": 5.0}
    )
    ;;81k
    (ref-TS01-C2::SWP|C_SimpleSwapNoSlippage
        KST.ANHD 
        KST.ANHD
        "W|OURO-98c486052a51|TEUR-98c486052a51|EURT-98c486052a51|EURC-98c486052a51|EURD-98c486052a51|AEUR-98c486052a51|CEUR-98c486052a51"
        "EURT-98c486052a51"
        2400.0
        "OURO-98c486052a51"
        ;{"expected-output-amount": 1809.280886324937455356121064,"output-precision": 24,"slippage-percent": 5.0}
    )
)

(print "")
(print "")
(format "<<<<<<<STEP 011b ONLY Swap Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(print "=======================Swap Tests=================================")
(begin-tx "SWP TX 11c - ONLY SWAP NO SLIPPAGE")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AncientHodler", "caps": [] }
    ]
)

(let
    (
        (ref-DALOS:module{OuronetDalosV2} DALOS)
        (ref-DPTF:module{DemiourgosPactTrueFungibleV2} DPTF)
        (ref-TS01-C2:module{TalosStageOne_ClientTwo} TS01-C2)
    )
    [
        (ref-TS01-C2::SWP|C_MultiSwapNoSlippage
            KST.ANHD 
            KST.ANHD
            "W|OURO-98c486052a51|TEUR-98c486052a51|EURT-98c486052a51|EURC-98c486052a51|EURD-98c486052a51|AEUR-98c486052a51|CEUR-98c486052a51"
            ["TEUR-98c486052a51" "EURT-98c486052a51" "EURC-98c486052a51" "EURD-98c486052a51" "AEUR-98c486052a51" "CEUR-98c486052a51"]
            [230.0 240.0 232.0 223.0 455.0 432.0]
            "OURO-98c486052a51"
        )
        (format "AH has {} GAS" [(ref-DPTF::UR_AccountSupply (ref-DALOS::UR_IgnisID) KST.ANHD)])
    ]
    
)

(print "")
(print "")
(format "<<<<<<<STEP 011c ONLY Swap Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(print "=======================Swap Tests=================================")
(begin-tx "SWP TX 12 - Add Liqudity")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AncientHodler", "caps": [] }
    ]
)

(let
    (
        ;(ref-DALOS:module{OuronetDalosV2} DALOS)
        ;(ref-DPTF:module{DemiourgosPactTrueFungibleV2} DPTF)
        (ref-TS01-C2:module{TalosStageOne_ClientTwo} TS01-C2)
        ;(ref-SWP:module{SwapperV2} SWP)
        ;(swp-sc:string (ref-DALOS::GOV|SWP|SC_NAME))
        (patron:string KST.ANHD)
        ;(pool1:string "W|DLK-98c486052a51|OURO-98c486052a51|DWK-98c486052a51")
        ;(pool2:string "S|DLK-98c486052a51|OURO-98c486052a51|DWK-98c486052a51")
        ;(pool3:string "P|OURO-98c486052a51|PKOSON-98c486052a51")
        ;(pool4:string "S|PKOSON-98c486052a51|EKOSON-98c486052a51|AKOSON-98c486052a51")
        ;(pool5:string "P|OURO-98c486052a51|BUSD-98c486052a51")
        ;(pool6:string "P|OURO-98c486052a51|VST-98c486052a51")

        ;(pool7:string "S|BUSD-98c486052a51|TUSD-98c486052a51|USDT-98c486052a51|USDC-98c486052a51|USDD-98c486052a51|AUSD-98c486052a51|CUSD-98c486052a51")
        ;(pool7:string "P|OURO-98c486052a51|TUSD-98c486052a51|USDT-98c486052a51|USDC-98c486052a51|USDD-98c486052a51|AUSD-98c486052a51|CUSD-98c486052a51")
        ;(pool7:string "W|OURO-98c486052a51|TUSD-98c486052a51|USDT-98c486052a51|USDC-98c486052a51|USDD-98c486052a51|AUSD-98c486052a51|CUSD-98c486052a51")

        (pool8:string "W|OURO-98c486052a51|TEUR-98c486052a51|EURT-98c486052a51|EURC-98c486052a51|EURD-98c486052a51|AEUR-98c486052a51|CEUR-98c486052a51")
        ;(pool8-lp:string (ref-SWP::UR_TokenLP pool8))
    )
    [
        (ref-TS01-C2::SWP|C_AddLiquidity
            patron 
            patron
            pool8
            [730.0 250.0 330.0 450.0 554.0 332.0 234.0]
        )
        ;(format "AH has {} GAS" [(ref-DPTF::UR_AccountSupply (ref-DALOS::UR_IgnisID) KST.ANHD)])
        ;(format "Pool8 LP is {}" [pool8-lp])
        ;(format "Burn role for LP on SWP-SC is {}" [(ref-DPTF::UR_AccountRoleBurn pool8-lp swp-sc)])
        ;(format "Mint role for LP on SWP-SC is {}" [(ref-DPTF::UR_AccountRoleMint pool8-lp swp-sc)])
        ;(format "Pool8-LP Owner is {}" [(ref-DPTF::UR_Konto pool8-lp)])
    ]
    
)

(print "")
(print "")
(format "<<<<<<<STEP 012 AddLiquidity Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(print "=======================Swap Tests=================================")
(begin-tx "SWP TX 13 - Add Balanced Liqudity")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AncientHodler", "caps": [] }
    ]
)

(let
    (
        (ref-DALOS:module{OuronetDalosV2} DALOS)
        (ref-DPTF:module{DemiourgosPactTrueFungibleV2} DPTF)
        (ref-SWPU:module{SwapperUsageV2} SWPU)
        (ref-TS01-C2:module{TalosStageOne_ClientTwo} TS01-C2)
        (patron:string KST.ANHD)
        ;(pool1:string "W|DLK-98c486052a51|OURO-98c486052a51|DWK-98c486052a51")
        ;(pool2:string "S|DLK-98c486052a51|OURO-98c486052a51|DWK-98c486052a51")
        ;(pool3:string "P|OURO-98c486052a51|PKOSON-98c486052a51")
        ;(pool4:string "S|PKOSON-98c486052a51|EKOSON-98c486052a51|AKOSON-98c486052a51")
        ;(pool5:string "P|OURO-98c486052a51|BUSD-98c486052a51")
        ;(pool6:string "P|OURO-98c486052a51|VST-98c486052a51")

        ;(pool7:string "S|BUSD-98c486052a51|TUSD-98c486052a51|USDT-98c486052a51|USDC-98c486052a51|USDD-98c486052a51|AUSD-98c486052a51|CUSD-98c486052a51")
        ;(pool7:string "P|OURO-98c486052a51|TUSD-98c486052a51|USDT-98c486052a51|USDC-98c486052a51|USDD-98c486052a51|AUSD-98c486052a51|CUSD-98c486052a51")
        ;(pool7:string "W|OURO-98c486052a51|TUSD-98c486052a51|USDT-98c486052a51|USDC-98c486052a51|USDD-98c486052a51|AUSD-98c486052a51|CUSD-98c486052a51")

        (pool8:string "W|OURO-98c486052a51|TEUR-98c486052a51|EURT-98c486052a51|EURC-98c486052a51|EURD-98c486052a51|AEUR-98c486052a51|CEUR-98c486052a51")
    )
    [
        (format "Balanced Liquidity with 500 OURO is{}, and adding liquidity so creates {} LP Tokens" 
            [
                (ref-SWPU::SWPLC|URC_BalancedLiquidity pool8 "OURO-98c486052a51" 500.0)
                (ref-TS01-C2::SWP|C_AddBalancedLiquidity
                    patron
                    patron
                    pool8
                    "OURO-98c486052a51"
                    500.0
                )
            ]
        )
        (format "AH has {} GAS" [(ref-DPTF::UR_AccountSupply (ref-DALOS::UR_IgnisID) patron)])
    ]
    
)

(print "")
(print "")
(format "<<<<<<<STEP 013 Add Balanced Liquidity Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(print "=======================Swap Tests=================================")
(begin-tx "SWP TX 14 - Worth Tests")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AncientHodler", "caps": [] }
    ]
)

(let
    (
        (ref-DALOS:module{OuronetDalosV2} DALOS)
        (ref-DPTF:module{DemiourgosPactTrueFungibleV2} DPTF)
        (ref-ATS:module{AutostakeV2} ATS)
        (ref-SWP:module{SwapperV2} SWP)
        (ref-SWPU:module{SwapperUsageV2} SWPU)
        (pool1:string "W|DLK-98c486052a51|OURO-98c486052a51|DWK-98c486052a51")
        (pool2:string "S|DLK-98c486052a51|OURO-98c486052a51|DWK-98c486052a51")
        (pool3:string "P|OURO-98c486052a51|PKOSON-98c486052a51")
        (pool4:string "S|PKOSON-98c486052a51|EKOSON-98c486052a51|AKOSON-98c486052a51")
        (pool5:string "P|OURO-98c486052a51|BUSD-98c486052a51")
        (pool6:string "P|OURO-98c486052a51|VST-98c486052a51")

        (pool7:string "S|BUSD-98c486052a51|TUSD-98c486052a51|USDT-98c486052a51|USDC-98c486052a51|USDD-98c486052a51|AUSD-98c486052a51|CUSD-98c486052a51")
        ;(pool7:string "P|OURO-98c486052a51|TUSD-98c486052a51|USDT-98c486052a51|USDC-98c486052a51|USDD-98c486052a51|AUSD-98c486052a51|CUSD-98c486052a51")
        ;(pool7:string "W|OURO-98c486052a51|TUSD-98c486052a51|USDT-98c486052a51|USDC-98c486052a51|USDD-98c486052a51|AUSD-98c486052a51|CUSD-98c486052a51")

        (pool8:string "W|OURO-98c486052a51|TEUR-98c486052a51|EURT-98c486052a51|EURC-98c486052a51|EURD-98c486052a51|AEUR-98c486052a51|CEUR-98c486052a51")

        (pts:[decimal] (ref-SWP::UR_PoolTokenSupplies pool1))
        (dlk-amount:decimal (at 0 pts))
        (dlk-amount-is-worth:decimal (ref-SWPU::URC_WorthDWK "DLK-98c486052a51" dlk-amount))

        (dlk-id:string (ref-DALOS::UR_LiquidKadenaID))
        (ats-pairs-with-dlk-id:[string] (ref-DPTF::UR_RewardBearingToken dlk-id))
        (kdaliquindex:string (at 0 ats-pairs-with-dlk-id))
        (index-value:decimal (ref-ATS::URC_Index kdaliquindex))

    )
    [
        (format "DLK in first pool is {}" [dlk-amount])
        (format "This amount is worth {} DWK" [dlk-amount-is-worth])
        (format "Because KDA-Liquid-Index is {}" [index-value])

        (format "OURO-98c486052a51 is worth {} DWK" [(ref-SWPU::URC_SingleWorthDWK "OURO-98c486052a51")])
        (format "Pool 1 is worth {} DWK" [(ref-SWPU::URC_PoolWorthDWK pool1)])
        (format "Pool 2 is worth {} DWK" [(ref-SWPU::URC_PoolWorthDWK pool2)])
        (format "Pool 3 is worth {} DWK" [(ref-SWPU::URC_PoolWorthDWK pool3)])
        (format "Pool 4 is worth {} DWK" [(ref-SWPU::URC_PoolWorthDWK pool4)])
        (format "Pool 5 is worth {} DWK" [(ref-SWPU::URC_PoolWorthDWK pool5)])
        (format "Pool 6 is worth {} DWK" [(ref-SWPU::URC_PoolWorthDWK pool6)])
        (format "Pool 7 is worth {} DWK" [(ref-SWPU::URC_PoolWorthDWK pool7)])
        (format "Pool 8 is worth {} DWK" [(ref-SWPU::URC_PoolWorthDWK pool8)])
        (format "AH has {} GAS" [(ref-DPTF::UR_AccountSupply (ref-DALOS::UR_IgnisID) KST.ANHD)])
    ]
    
)

(print "")
(print "")
(format "<<<<<<<STEP 014 Worth Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(print "=======================Swap Tests=================================")
(begin-tx "SWP TX 15 - Fueling Tests")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AncientHodler", "caps": [] }
    ]
)

(let
    (
        (ref-ORBR:module{OuroborosV2} OUROBOROS)
        (ref-TS01-A:module{TalosStageOne_AdminV2} TS01-A)
        (indices:[decimal] (ref-ORBR::URC_ProjectedKdaLiquindex))
    )
    [
        (format "Current Liquindex is {}, Projected Liquindex is" [(at 0 indices) (at 1 indices)])
    ]
    (ref-TS01-A::ORBR|A_Fuel)
    (let
        (
            (ref-DALOS:module{OuronetDalosV2} DALOS)
            (ref-DPTF:module{DemiourgosPactTrueFungibleV2} DPTF)
            (ref-ATS:module{AutostakeV2} ATS)

            (dlk-id:string (ref-DALOS::UR_LiquidKadenaID))
            (ats-pairs-with-dlk-id:[string] (ref-DPTF::UR_RewardBearingToken dlk-id))
            (kdaliquindex:string (at 0 ats-pairs-with-dlk-id))
            (index-value:decimal (ref-ATS::URC_Index kdaliquindex))
        )
        [
            (format "Initial Liquindex is {}, Projected Liquindex is {}, from {} KDA to be used for fueling" [(at 0 indices) (at 1 indices) (at 2 indices)])
            (format "After Manual Fuel, Current Liquindex is {}" [index-value])
        ]
    )
)

(print "")
(print "")
(format "<<<<<<<STEP 015 Fueling Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(print "=======================Resereve Tests=================================")
(begin-tx "SWP TX 16 - Deploy Smart Account")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(let
    (
        (ref-coin:module{fungible-v2} coin)
        (ref-U|CT:module{OuronetConstants} U|CT)
        (ref-DALOS:module{OuronetDalosV2} DALOS)
        (ref-TS01-C1:module{TalosStageOne_ClientOne} TS01-C1)
        (patron:string KST.ANHD)
        
        (nsuse:string (ref-U|CT::CT_NS_USE))
        (ah-ouronet-account:string "Σ.éXødVțrřĄθ7ΛдUŒjeßćιiXTПЗÚĞqŸœÈэαLżØôćmч₱ęãΛě$êůáØCЗшõyĂźςÜãθΘзШË¥şEÈnxΞЗÚÏÛjDVЪжγÏŽнăъçùαìrпцДЖöŃȘâÿřh£1vĎO£κнβдłпČлÿáZiĐą8ÊHÂßĎЩmEBцÄĎвЙßÌ5Ï7ĘŘùrÑckeñëδšПχÌàî")
        (ah-key (+ nsuse ".dh_ah-keyset"))
        (ah-kda:string "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263")
        (ah-pbl:string "9G.CgcAjiI89ICnk45mxx63hwkBe5G71sIqfEta0ugkzF7EB6cy55BtzlFa27jDGE7Kn7ChljCmkcIsrDw9JwzJECieGLB5Jlkz9Blo6iJct6uxIA1u64Hr7HKa93EAiCwJJBBKAojJtwupEsvspH1jjGxKyFsb8fbfnJm1rAKxcIzcFILmmdHFaICfFpnbJG6tJu0HM9JCJ7MBCE7C2LiqvE6Fc1hqCeAdGHxDp7sGquI0wl2l08aa6wlKvwu44jgqF8mqDnCyjpxHuttEqjs4h9IJ28kmB53ppwoznt16rjzeMl21n3rwfI2es56rp5xavCabDacyCuonniz72L5d7dq3ptIEiuggEyLIIGe9sadH6eaMyitcmKaH7orgFz6d9kL9FKorBr06owFg328wFhCIlCFpwIzokmo47xKKt5kBzhyodBAjhCqayuHBue4oDhoA21A2H9ut9gApMuxokcmsi7Bd1kitrfJAy1GkrGiBK5dvlhgshcnGaG3vhkCm6dI5idCGjDEodivvDbgyI6zaajHvIMdBtrGvuKnxvsBulkbaDbk2wIdKwrK")
        (balance:decimal (ref-coin::get-balance "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263"))

        (split-kda:[decimal] 
            (ref-DALOS::URC_SplitKDAPrices
                ah-ouronet-account
                (ref-DALOS::UR_UsagePrice "smart")
            )
        )
    )
    (env-sigs
        [   
            { "key": "PK_AncientHodler", "caps": [] }
            { "key": "6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" , 
              "caps": 
                [
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "k:50d6c59b21e5e6e55baecaa75a1007de37576bde12d8230dc82459cc01b9484b"
                        (at 2 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "k:0cb30c0121ff919266121a99ff9359871818932211df94dae4137c29bc0e8f7e"
                        (at 0 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "c:Y_iaJ6fE-ic7kwTtLfty66e3zyGGYIX7OdiMrIdkYBg"
                        (at 3 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "c:HVNhO-WfROlC-guMUNk91MJWPzfSiP1O7Ip4T4g93O0"
                        (at 1 split-kda)
                    )
                ] 
            }
        ]
    )
    (ref-TS01-C1::DALOS|C_DeploySmartAccount
        ah-ouronet-account
        (keyset-ref-guard ah-key) 
        ah-kda 
        patron 
        ah-pbl
    )
)

(print "")
(print "")
(format "<<<<<<<STEP 016 Deploying Smart Account Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(print "=======================Swap Tests=================================")
(begin-tx "SWP TX 17 - Reservation Tests")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AncientHodler", "caps": [] }
    ]
)

(let
    (
        (ref-DALOS:module{OuronetDalosV2} DALOS)
        (ref-DPTF:module{DemiourgosPactTrueFungibleV2} DPTF)
        (ref-TFT:module{TrueFungibleTransferV2} TFT)
        (ref-VST:module{VestingV2} VST)
        (ref-TS01-C1:module{TalosStageOne_ClientOne} TS01-C1)
        (ref-TS01-C2:module{TalosStageOne_ClientTwo} TS01-C2)
        (OuroID:string (ref-DALOS::UR_OuroborosID))
        (IgnisID:string (ref-DALOS::UR_IgnisID))
        (ROuroID:string (ref-DPTF::UR_Reservation OuroID))
        (patron:string KST.ANHD)
        (smart-patron:string "Σ.éXødVțrřĄθ7ΛдUŒjeßćιiXTПЗÚĞqŸœÈэαLżØôćmч₱ęãΛě$êůáØCЗшõyĂźςÜãθΘзШË¥şEÈnxΞЗÚÏÛjDVЪжγÏŽнăъçùαìrпцДЖöŃȘâÿřh£1vĎO£κнβдłпČлÿáZiĐą8ÊHÂßĎЩmEBцÄĎвЙßÌ5Ï7ĘŘùrÑckeñëδšПχÌàî")
        (emma:string KST.EMMA)
    )
    ;;Turn ON Reserve Functionality
    (ref-TS01-C1::DPTF|C_ToggleReservation patron OuroID true)
    ;;Standard Account makes 15 R|Ouro
    (ref-TS01-C2::VST|C_Reserve patron patron OuroID 15.0)
    (let
        (
            (r-dptf-balance:decimal (ref-DPTF::UR_AccountSupply ROuroID patron))
        )
        ;;Deploy Account for ROuroID on Smart-Patron
        (ref-TS01-C1::DPTF|C_DeployAccount ROuroID smart-patron)
        ;;Transfer Role set to true to Smart Account.
        (ref-TS01-C1::DPTF|C_ToggleTransferRole patron ROuroID smart-patron true)
        ;;Send 15 R|Ouro to Smart Account
        (ref-TS01-C1::DPTF|C_Transfer patron ROuroID patron smart-patron 15.0 true)
        ;;Smart Account unreserves 10 Ouro
        (ref-TS01-C2::VST|C_Unreserve patron smart-patron ROuroID 10.0)

        ;;
        ;(ref-TS01-C2::VST|C_RepurposeReserved patron ROuroID patron emma)
        (let
            (
                (r2-dptf-balance:decimal (ref-DPTF::UR_AccountSupply ROuroID smart-patron))
                (r3-dptf-balance:decimal (ref-DPTF::UR_AccountSupply OuroID smart-patron))
            )
            ;;Show R|Ouro Balances, after reserve and after unreserve
            [
                (format "AH Standard has {} Reserved Ouro after first reservation" [r-dptf-balance])
                (format "AH Smart has {} Reserved Ouro after unreserve action" [r2-dptf-balance])
                (format "AH Smart has {} Ouro after unreserve action" [r3-dptf-balance])
                ;(format "Emma has {} {} after repurpose"[(ref-DPTF::UR_AccountSupply ROuroID emma) ROuroID])
            ]
        )
    )
)

(print "")
(print "")
(format "<<<<<<<STEP 017 Reservation Tests Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(print "=======================Swap Tests=================================")
(begin-tx "SWP TX 18 - Frozen Tests")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AncientHodler", "caps": [] }
    ]
)

(let
    (
        (ref-TS01-C1:module{TalosStageOne_ClientOne} TS01-C1)
        (ref-TS01-C2:module{TalosStageOne_ClientTwo} TS01-C2)
        (ref-VST:module{VestingV2} VST)
        (vst:string "VST-98c486052a51")
        (patron:string KST.ANHD)
        (emma:string KST.EMMA)
        (ref-DPTF:module{DemiourgosPactTrueFungibleV2} DPTF)
        (f-vst:string (ref-DPTF::UR_Frozen vst))
        
    )
    ;;Mint 1000 VST
    ;(ref-TS01-C1::DPTF|C_Mint patron vst patron 100000000.0 false)
    ;;Freeze 500 VST to Emma
    (ref-TS01-C2::VST|C_Freeze patron patron emma vst 10000000.0)
    ;;Show Emmas Balance
    ;(format "Emma has {} {}"[(ref-DPTF::UR_AccountSupply f-vst emma) f-vst])
    ;;Repurpose frozen Token back to AH
    (ref-TS01-C2::VST|C_RepurposeFrozen patron f-vst emma patron)
    ;(ref-VST::XI_RepurposeTrueFungible patron f-vst emma patron true)
    ;;Show AH Balance
    (format "AH has {} {} after repurpose"[(ref-DPTF::UR_AccountSupply f-vst patron) f-vst])
)

(print "")
(print "")
(format "<<<<<<<STEP 018 Freeze Tests Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(print "=======================Swap Tests=================================")
(begin-tx "SWP TX 19 - Sleeping Tests")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AncientHodler", "caps": [] }
        { "key": "PK_Emma", "caps": [] }
    ]
)

(let
    (
        (ref-VST:module{VestingV2} VST)
        (ref-TS01-C2:module{TalosStageOne_ClientTwo} TS01-C2)
        (vst:string "VST-98c486052a51")
        (patron:string KST.ANHD)
        (emma:string KST.EMMA)
        (ref-DPTF:module{DemiourgosPactTrueFungibleV2} DPTF)
        (ref-DPMF:module{DemiourgosPactMetaFungibleV2} DPMF)
        (s-vst:string (ref-DPTF::UR_Sleeping vst))
        (p:string ".")
        
    )
    ;;Sleept 6500 VST to Emma
    (ref-TS01-C2::VST|C_Sleep patron patron emma vst 5000.0 432000)
    (ref-TS01-C2::VST|C_Sleep patron patron emma vst 6000.0 518400)
    (ref-TS01-C2::VST|C_Sleep patron patron emma vst 7000.0 604800)
    (ref-TS01-C2::VST|C_Sleep patron patron emma vst 8000.0 691200)
    (ref-TS01-C2::VST|C_Sleep patron patron emma vst 9000.0 777600)

    (ref-TS01-C2::VST|C_Sleep patron patron emma vst 5000.0 5432000)
    (ref-TS01-C2::VST|C_Sleep patron patron emma vst 6000.0 4518400)
    (ref-TS01-C2::VST|C_Sleep patron patron emma vst 7000.0 3604800)
    (ref-TS01-C2::VST|C_Sleep patron patron emma vst 8000.0 2691200)
    (ref-TS01-C2::VST|C_Sleep patron patron emma vst 9000.0 1777600)

    (ref-TS01-C2::VST|C_Sleep patron patron emma vst 5000.0 5432000)
    (ref-TS01-C2::VST|C_Sleep patron patron emma vst 6000.0 4518400)
    (ref-TS01-C2::VST|C_Sleep patron patron emma vst 7000.0 3604800)
    (ref-TS01-C2::VST|C_Sleep patron patron emma vst 8000.0 2691200)
    (ref-TS01-C2::VST|C_Sleep patron patron emma vst 9000.0 2777600)

    (ref-TS01-C2::VST|C_Sleep patron patron emma vst 51000.0 432000)
    (ref-TS01-C2::VST|C_Sleep patron patron emma vst 6000.0 1518400)
    (ref-TS01-C2::VST|C_Sleep patron patron emma vst 7000.0 1604800)
    (ref-TS01-C2::VST|C_Sleep patron patron emma vst 8000.0 2691200)
    (ref-TS01-C2::VST|C_Sleep patron patron emma vst 9000.0 1777600)

    (ref-TS01-C2::VST|C_Sleep patron patron emma vst 57000.0 432000)
    (ref-TS01-C2::VST|C_Sleep patron patron emma vst 6000.0 1518400)
    (ref-TS01-C2::VST|C_Sleep patron patron emma vst 7000.0 1604800)
    (ref-TS01-C2::VST|C_Sleep patron patron emma vst 8000.0 2691200)
    (ref-TS01-C2::VST|C_Sleep patron patron emma vst 9000.0 1777600)

    (ref-TS01-C2::VST|C_Sleep patron patron emma vst 13000.0 432000)
    (ref-TS01-C2::VST|C_Sleep patron patron emma vst 6000.0 1518400)
    (ref-TS01-C2::VST|C_Sleep patron patron emma vst 7000.0 1604800)
    (ref-TS01-C2::VST|C_Sleep patron patron emma vst 8000.0 2691200)
    (ref-TS01-C2::VST|C_Sleep patron patron emma vst 9000.0 1777600)

    ;;Show Emmas Balance
    
    (env-chain-data
        {"prev-block-hash": "98c486052a5147fdd30fa43cc6d67e0a4e680c856c37f9157cb788cd67d58006",
         "block-time": (time "2024-10-16T00:00:00Z")}
    )
    ;(ref-TS01-C2::VST|C_RepurposeSleeping patron s-vst 30 emma patron)
    [
        (format "<<<<<>>>>>{}" [p])
        (format "Emma has {} {} in total, owned nonces are {}"[(ref-DPMF::UR_AccountSupply s-vst emma) s-vst (ref-DPMF::UR_AccountNonces s-vst emma)])
        (format "<<<<<>>>>>{}" [p])
        (format "Emma VST supply is {}" [(ref-DPTF::UR_AccountSupply vst emma)])
        (format "<<<<<>>>>>{}" [p])
        (format "<<<<<>>>>>{}" [p])
        (format "AH has {} {} in total after repurpose, owned nonces are {}"[(ref-DPMF::UR_AccountSupply s-vst patron) s-vst (ref-DPMF::UR_AccountNonces s-vst patron)])
    ]
)

(print "")
(print "")
(format "<<<<<<<STEP 019 Sleeping Tests Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(print "=======================Swap Tests=================================")
(begin-tx "SWP TX 19 - Sleeping Tests")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AncientHodler", "caps": [] }
        { "key": "PK_Emma", "caps": [] }
    ]
)

(let
    (
        (ref-DPTF:module{DemiourgosPactTrueFungibleV2} DPTF)
        (ref-DPMF:module{DemiourgosPactMetaFungibleV2} DPMF)
        (ref-TS01-C2:module{TalosStageOne_ClientTwo} TS01-C2)
    )
    ;(ref-TS01-C2::VST|C_Merge KST.EMMA KST.EMMA "Z|VST-98c486052a51" (enumerate 1 30))
    ;(ref-TS01-C2::VST|C_MergeAll KST.EMMA KST.EMMA "Z|VST-98c486052a51")
    ;(ref-TS01-C2::VST|C_RepurposeMerge KST.EMMA "Z|VST-98c486052a51" (enumerate 1 10) KST.EMMA KST.ANHD)
    (ref-TS01-C2::VST|C_RepurposeMergeAll KST.EMMA "Z|VST-98c486052a51" KST.EMMA KST.ANHD)
    [
        (format "Emma has {} {} in total, owned nonces are {}"[(ref-DPMF::UR_AccountSupply "Z|VST-98c486052a51" KST.EMMA) "Z|VST-98c486052a51" (ref-DPMF::UR_AccountNonces "Z|VST-98c486052a51" KST.EMMA)])
        (format "Emma VST supply is {}" [(ref-DPTF::UR_AccountSupply "VST-98c486052a51" KST.EMMA)])
        (format "Ah has {} {} in total, owned nonces are {}"[(ref-DPMF::UR_AccountSupply "Z|VST-98c486052a51" KST.ANHD) "Z|VST-98c486052a51" (ref-DPMF::UR_AccountNonces "Z|VST-98c486052a51" KST.ANHD)])
        (format "Ah VST supply is {}" [(ref-DPTF::UR_AccountSupply "VST-98c486052a51" KST.ANHD)])
    ]
)

(print "")
(print "")
(format "<<<<<<<STEP 020 Sleeping Tests Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(print "=======================Swap Tests=================================")
(begin-tx "SWP TX 21 - Vesting Tests")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AncientHodler", "caps": [] }
        { "key": "PK_Emma", "caps": [] }
    ]
)

(let
    (
        (ref-DPTF:module{DemiourgosPactTrueFungibleV2} DPTF)
        (ref-DPMF:module{DemiourgosPactMetaFungibleV2} DPMF)
        (ref-TS01-C2:module{TalosStageOne_ClientTwo} TS01-C2)
        (ouro:string "OURO-98c486052a51")
        (v-ouro:string "V|OURO-98c486052a51")
        (patron:string KST.ANHD)
        (emma:string KST.EMMA)
    )
    ;(ref-TS01-C2::VST|C_Merge KST.EMMA KST.EMMA "Z|VST-98c486052a51" (enumerate 1 30))
    (ref-TS01-C2::VST|C_Vest patron patron emma ouro 250.0 3600 7200 20)
    [
        (format "Emma has {} {} in total, owned nonces are {}"[(ref-DPMF::UR_AccountSupply v-ouro emma) v-ouro (ref-DPMF::UR_AccountNonces v-ouro emma)])
        (format "Emma Vested-Ouro Unit is {}" [(ref-DPMF::UR_AccountUnit v-ouro emma)])
        (format "Emma OURO supply is {}" [(ref-DPTF::UR_AccountSupply ouro emma)])
    ]
)

(print "")
(print "")
(format "<<<<<<<STEP 021 Vesting Tests Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(print "=======================Swap Tests=================================")
(begin-tx "SWP TX 22 - Vesting Tests")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AncientHodler", "caps": [] }
        { "key": "PK_Emma", "caps": [] }
    ]
)

(let
    (
        (ref-DPTF:module{DemiourgosPactTrueFungibleV2} DPTF)
        (ref-DPMF:module{DemiourgosPactMetaFungibleV2} DPMF)
        (ref-VST:module{VestingV2} VST)
        (ref-TS01-C2:module{TalosStageOne_ClientTwo} TS01-C2)
        (ouro:string "OURO-98c486052a51")
        (v-ouro:string "V|OURO-98c486052a51")
        (patron:string KST.ANHD)
        (emma:string KST.EMMA)
    )
    (env-chain-data
        {"prev-block-hash": "98c486052a5147fdd30fa43cc6d67e0a4e680c856c37f9157cb788cd67d58006",
         "block-time": (time "2024-10-16T13:00:00Z")}
    )
    ;(ref-TS01-C2::VST|C_Unvest emma emma v-ouro 1)
    [
        ;(format "Account Nonce Balance is {}" [(ref-DPMF::UR_AccountNonceBalance v-ouro 1 emma)])
        ;(format "Culled Amount is {}" [(ref-VST::URC_CullMetaDataAmount emma v-ouro 1)])
        (format "Emma has {} {} in total, owned nonces are {}"[(ref-DPMF::UR_AccountSupply v-ouro emma) v-ouro (ref-DPMF::UR_AccountNonces v-ouro emma)])
        (format "Emma Vested-Ouro Unit is {}" [(ref-DPMF::UR_AccountUnit v-ouro emma)])
        (format "Emma OURO supply is {}" [(ref-DPTF::UR_AccountSupply ouro emma)])
        (format "Emma GAS supply is {}" [(ref-DPTF::UR_AccountSupply "GAS-98c486052a51" emma)])
    ]
)

(print "")
(print "")
(format "<<<<<<<STEP 022 Vesting Tests Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(print "=======================Swap Tests=================================")
(begin-tx "SWP TX 23 - Vesting Tests")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AncientHodler", "caps": [] }
        { "key": "PK_Emma", "caps": [] }
    ]
)

(let
    (
        (ref-TS01-C1:module{TalosStageOne_ClientOne} TS01-C1)
    )
    (ref-TS01-C1::DPMF|C_DeployAccount "V|OURO-98c486052a51" KST.ANHD)
    (ref-TS01-C1::DPMF|C_ToggleTransferRole KST.ANHD "V|OURO-98c486052a51" KST.ANHD true)
)

(print "")
(print "")
(format "<<<<<<<STEP 023 Vesting Tests Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(print "=======================Swap Tests=================================")
(begin-tx "SWP TX 24 - Vesting Tests")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AncientHodler", "caps": [] }
        { "key": "PK_Emma", "caps": [] }
    ]
)

(let
    (
        (ref-DALOS:module{OuronetDalosV2} DALOS)
        (ref-DPTF:module{DemiourgosPactTrueFungibleV2} DPTF)
        (ref-DPMF:module{DemiourgosPactMetaFungibleV2} DPMF)
        (ref-TS01-C1:module{TalosStageOne_ClientOne} TS01-C1)
        (ref-TS01-C2:module{TalosStageOne_ClientTwo} TS01-C2)
    )
    ;(ref-TS01-C1::DPMF|C_Transfer KST.EMMA "V|OURO-98c486052a51" 1 KST.EMMA KST.ANHD 100.0 false)
    ;(expect-failure "No Cull Possible" (ref-TS01-C2::VST|C_Unvest KST.EMMA KST.EMMA "V|OURO-98c486052a51" 2))
    (ref-TS01-C2::VST|C_Unvest KST.EMMA KST.EMMA "V|OURO-98c486052a51" 1)
    ;[
    ;    ;(format "Account Nonce Balance is {}" [(ref-DPMF::UR_AccountNonceBalance v-ouro 1 emma)])
    ;    ;(format "Culled Amount is {}" [(ref-VST::URC_CullMetaDataAmount emma v-ouro 1)])
    ;    (format "AH has {} {} in total, owned nonces are {}"[(ref-DPMF::UR_AccountSupply "V|OURO-98c486052a51" KST.ANHD) "V|OURO-98c486052a51" (ref-DPMF::UR_AccountNonces "V|OURO-98c486052a51" KST.ANHD)])
    ;    (format "AH Vested-Ouro Unit is {}" [(ref-DPMF::UR_AccountUnit "V|OURO-98c486052a51" KST.ANHD)])
    ;    (format "AH OURO supply is {}" [(ref-DPTF::UR_AccountSupply "OURO-98c486052a51" KST.ANHD)])
    ;]
    [
        (format "Emma GAS supply after unvest is {}" [(ref-DPTF::UR_AccountSupply "GAS-98c486052a51" KST.EMMA)])
        (format "Emma has Ignis Gas Discount {}" [(ref-DALOS::URC_IgnisGasDiscount KST.EMMA)])
    ]
)

(print "")
(print "")
(format "<<<<<<<STEP 024 Vesting Tests Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(print "=======================Swap Tests=================================")
(begin-tx "SWP TX 25 - Frozen Functionality SWP Tests")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AncientHodler", "caps": [] }
        { "key": "PK_Emma", "caps": [] }
    ]
)

(let
    (
        (ref-DALOS:module{OuronetDalosV2} DALOS)
        (ref-DPTF:module{DemiourgosPactTrueFungibleV2} DPTF)
        (ref-VST:module{VestingV2} VST)
        (ref-TS01-C2:module{TalosStageOne_ClientTwo} TS01-C2)
        (patron:string KST.ANHD)
        (emma:string KST.EMMA)
        (pool:string "P|OURO-98c486052a51|VST-98c486052a51")
        (lp-id "P|OURO-VST|LP-98c486052a51")
        (split-kda:[decimal] 
            (ref-DALOS::URC_SplitKDAPrices
                emma
                (+ (ref-DALOS::UR_UsagePrice "dptf") (ref-DALOS::UR_UsagePrice "dpmf"))
            )
        )
        (swp-sc:string (ref-DALOS::GOV|SWP|SC_NAME))
    )
    ;"k:ecaeae048b6e4b1d4cd9b5ba41041b39e05ac3a7b32f495a12823cb1c5ad0f48" emma
    ;"k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" ah
    (env-sigs
        [   
            { "key": "PK_Emma", "caps": [] }
            { "key": "ecaeae048b6e4b1d4cd9b5ba41041b39e05ac3a7b32f495a12823cb1c5ad0f48" , 
              "caps": 
                [
                    (coin.TRANSFER 
                        "k:ecaeae048b6e4b1d4cd9b5ba41041b39e05ac3a7b32f495a12823cb1c5ad0f48" 
                        "k:50d6c59b21e5e6e55baecaa75a1007de37576bde12d8230dc82459cc01b9484b"
                        (at 2 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:ecaeae048b6e4b1d4cd9b5ba41041b39e05ac3a7b32f495a12823cb1c5ad0f48" 
                        "k:0cb30c0121ff919266121a99ff9359871818932211df94dae4137c29bc0e8f7e"
                        (at 0 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:ecaeae048b6e4b1d4cd9b5ba41041b39e05ac3a7b32f495a12823cb1c5ad0f48" 
                        "c:Y_iaJ6fE-ic7kwTtLfty66e3zyGGYIX7OdiMrIdkYBg"
                        (at 3 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:ecaeae048b6e4b1d4cd9b5ba41041b39e05ac3a7b32f495a12823cb1c5ad0f48" 
                        "c:HVNhO-WfROlC-guMUNk91MJWPzfSiP1O7Ip4T4g93O0"
                        (at 1 split-kda)
                    )
                ]
            }
        ]
    )
    (ref-TS01-C2::SWP|C_EnableFrozenLP emma pool)
    (ref-TS01-C2::SWP|C_EnableSleepingLP emma pool)
)

(print "")
(print "")
(format "<<<<<<<STEP 025 Enable Frozen LP Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(print "=======================Swap Tests=================================")
(begin-tx "SWP TX 26 - Add Frozen Liquidity")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AncientHodler", "caps": [] }
        { "key": "PK_Emma", "caps": [] }
    ]
)

(let
    (
        
        ;
        ;(ref-VST:module{VestingV2} VST)
        ;(emma:string KST.EMMA)
        ;(pool:string "P|OURO-98c486052a51|VST-98c486052a51")
        ;(lp-id "P|OURO-VST|LP-98c486052a51")
        (ref-DALOS:module{OuronetDalosV2} DALOS)
        (ref-DPTF:module{DemiourgosPactTrueFungibleV2} DPTF)
        (ref-DPMF:module{DemiourgosPactMetaFungibleV2} DPMF)
        (ref-TS01-C2:module{TalosStageOne_ClientTwo} TS01-C2)
        (ref-SWPU:module{SwapperUsageV2} SWPU)
        (ref-SWP:module{SwapperV2} SWP)
        (patron:string KST.ANHD)
        (emma:string KST.EMMA)
        (f-vst:string "F|VST-98c486052a51")
        (s-vst:string "Z|VST-98c486052a51")
        (swp-sc:string (ref-DALOS::GOV|SWP|SC_NAME))
        (pool:string "P|OURO-98c486052a51|VST-98c486052a51")
        (pool-lp:string (ref-SWP::UR_TokenLP pool))
        (f-lp:string (ref-DPTF::UR_Frozen pool-lp))
        (s-lp:string (ref-DPTF::UR_Sleeping pool-lp))
    )
    (ref-TS01-C2::SWP|C_AddSleepingLiquidity patron patron pool s-vst 31)
    (ref-TS01-C2::SWP|C_AddFrozenLiquidity patron patron pool f-vst 1000000.0)
    (ref-TS01-C2::SWP|C_ToggleFeeLock patron pool true)
    ;(ref-DPMF::UR_AccountNonceMetaData s-vst 31 patron)
    [
        (format "AH has {} {} in total, owned nonces are {}"[(ref-DPMF::UR_AccountSupply s-vst patron) s-vst (ref-DPMF::UR_AccountNonces s-vst patron)])
        (format "Pool LP Capacity is {}" [(ref-SWPU::SWPLC|URC_LpCapacity pool)])
        (format "Pool Token Supplies are {}" [(ref-SWP::UR_PoolTokenSupplies pool)])
        (format "AH has {} {}" [(ref-DPTF::UR_AccountSupply f-lp patron) f-lp])
        (format "AH has {} {}" [(ref-DPMF::UR_AccountSupply s-lp patron) s-lp])
    ]
)

(print "")
(print "")
(format "<<<<<<<STEP 026 Add Frozen/Sleeping VST Transfer Role costs Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(print "=======================Swap Tests=================================")
(begin-tx "SWP TX 27 - Change Ownership Test")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AncientHodler", "caps": [] }
        { "key": "PK_Emma", "caps": [] }
        { "key": "PK_AOZ", "caps": [] }
    ]
)

(let
    (
        
        ;
        ;(ref-VST:module{VestingV2} VST)
        ;(emma:string KST.EMMA)
        ;(pool:string "P|OURO-98c486052a51|VST-98c486052a51")
        ;(lp-id "P|OURO-VST|LP-98c486052a51")
        (ref-DALOS:module{OuronetDalosV2} DALOS)
        (ref-DPTF:module{DemiourgosPactTrueFungibleV2} DPTF)
        (ref-DPMF:module{DemiourgosPactMetaFungibleV2} DPMF)
        (ref-TS01-C2:module{TalosStageOne_ClientTwo} TS01-C2)
        (ref-SWPU:module{SwapperUsageV2} SWPU)
        (ref-SWP:module{SwapperV2} SWP)
        (patron:string KST.ANHD)
        (emma:string KST.EMMA)
        (f-vst:string "F|VST-98c486052a51")
        (s-vst:string "Z|VST-98c486052a51")
        (swp-sc:string (ref-DALOS::GOV|SWP|SC_NAME))
        (pool:string "P|OURO-98c486052a51|VST-98c486052a51")
        (pool-lp:string (ref-SWP::UR_TokenLP pool))
        (f-lp:string (ref-DPTF::UR_Frozen pool-lp))
        (s-lp:string (ref-DPTF::UR_Sleeping pool-lp))

        (wp:string "W|DLK-98c486052a51|OURO-98c486052a51|DWK-98c486052a51")
        (wp-lp:string (ref-SWP::UR_TokenLP wp))

        (sp:string "S|PKOSON-98c486052a51|EKOSON-98c486052a51|AKOSON-98c486052a51")

        (dlk:string "DLK-98c486052a51")
        (ouro:string "OURO-98c486052a51")
        (dwk:string "DWK-98c486052a51")
        (ignis:string "GAS-98c486052a51")

    )
    (ref-TS01-C2::SWP|C_ChangeOwnership patron pool emma)
    (ref-TS01-C2::SWP|C_ModifyCanChangeOwner patron pool false)
    (ref-TS01-C2::SWP|C_ModifyCanChangeOwner patron pool true)
    (ref-TS01-C2::SWP|C_ChangeOwnership patron pool patron)
    (ref-TS01-C2::SWP|C_ModifyWeights patron wp [0.25 0.25 0.50])
    (ref-TS01-C2::SWP|C_UpdateAmplifier patron sp 95.0)

    ;;
    (ref-TS01-C2::SWP|C_RemoveLiquidity patron patron wp 10000000.0)
    (ref-TS01-C2::SWP|C_AddLiquidity
        patron 
        patron
        wp
        [2000.0 2500.0 2000.0]
    )
    (ref-TS01-C2::ORBR|C_Compress patron patron 1000.0)
    [
        (format "AH has {} Ignis and {} OURO" [(ref-DPTF::UR_AccountSupply ignis patron) (ref-DPTF::UR_AccountSupply ouro patron )])
        (format "Pool {} owner is {}" [pool (ref-SWP::UR_OwnerKonto pool)])
        (format "Cand change owner for pool {} is {}" [pool (ref-SWP::UR_CanChangeOwner pool)])
        (format "Weigthed Pool weigths are {}" [(ref-SWP::UR_Weigths wp)])
        (format "Stable pool amplifier is {}" [(ref-SWP::UR_Amplifier sp)])
        (format "AH has {} {}" [(ref-DPTF::UR_AccountSupply wp-lp patron) wp-lp])
        (format "{} total supply is {}" [wp-lp (ref-DPTF::UR_Supply wp-lp)])
        (format "Pool {} suply of tokens is {}" [wp (ref-SWP::UR_PoolTokenSupplies wp)])

        (format "AH has {} {}, {} {}, and {} {}"
            [
                (ref-DPTF::UR_AccountSupply dlk patron)
                dlk
                (ref-DPTF::UR_AccountSupply ouro patron)
                ouro
                (ref-DPTF::UR_AccountSupply dwk patron)
                dwk
            ]
        )
    ]
    
)

(print "")
(print "")
(format "<<<<<<<SWP TX 27 - Change Ownership Test Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(begin-tx "SWP TX 28 Withdraw Fees Test")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AncientHodler", "caps": [] }
        { "key": "PK_Emma", "caps": [] }
        { "key": "PK_AOZ", "caps": [] }
    ]
)
(let
    (
        (ref-DALOS:module{OuronetDalosV2} DALOS)
        (ref-SWP:module{SwapperV2} SWP)
        (ref-TS01-C1:module{TalosStageOne_ClientOne} TS01-C1)
        (ref-TS01-C2:module{TalosStageOne_ClientTwo} TS01-C2)
        (patron:string KST.ANHD)
        (emma:string KST.EMMA)
        (split-kda:[decimal] 
            (ref-DALOS::URC_SplitKDAPrices
                patron
                (ref-DALOS::UR_UsagePrice "dptf")
            )
        )
    )
    (env-sigs
        [   
            { "key": "PK_AncientHodler", "caps": [] }
            { "key": "6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" , 
              "caps": 
                [
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "k:50d6c59b21e5e6e55baecaa75a1007de37576bde12d8230dc82459cc01b9484b"
                        (at 2 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "k:0cb30c0121ff919266121a99ff9359871818932211df94dae4137c29bc0e8f7e"
                        (at 0 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "c:Y_iaJ6fE-ic7kwTtLfty66e3zyGGYIX7OdiMrIdkYBg"
                        (at 3 split-kda)
                    )
                    (coin.TRANSFER 
                        "k:6fa1d9c3e5078a54038159c9a6bd7182301e16d6f280615eddb18b8bd2d6c263" 
                        "c:HVNhO-WfROlC-guMUNk91MJWPzfSiP1O7Ip4T4g93O0"
                        (at 1 split-kda)
                    )
                ] 
            }
        ]
    )
    (let
        (
            (ids:list
                (ref-TS01-C1::DPTF|C_Issue
                    patron
                    patron
                    ["BlessedVesta"]
                    ["BVST"]
                    [24]
                    [true]
                    [true]
                    [true]
                    [true]
                    [true]
                    [true]
                )
            )
            (bvst-id:string (at 0 ids))
        )
        (print "")
        (print "")
        (format "<<<<<<<Issue Data is {} >>>>>>>" [bvst-id])
    )
)
(print "")
(print "")
(format "<<<<<<<SWP TX 28 Withdraw Fees Test Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(print "=======================Swap Tests=================================")
(begin-tx "SWP TX 27 - Change Ownership Test")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AncientHodler", "caps": [] }
        { "key": "PK_Emma", "caps": [] }
        { "key": "PK_AOZ", "caps": [] }
    ]
)

(let
    (
        
        ;
        ;(ref-VST:module{VestingV2} VST)
        ;(emma:string KST.EMMA)
        ;(pool:string "P|OURO-98c486052a51|VST-98c486052a51")
        ;(lp-id "P|OURO-VST|LP-98c486052a51")
        (ref-DALOS:module{OuronetDalosV2} DALOS)
        (ref-DPTF:module{DemiourgosPactTrueFungibleV2} DPTF)
        (ref-DPMF:module{DemiourgosPactMetaFungibleV2} DPMF)
        (ref-TS01-A:module{TalosStageOne_AdminV2} TS01-A)
        (ref-TS01-C1:module{TalosStageOne_ClientOne} TS01-C1)
        (ref-TS01-C2:module{TalosStageOne_ClientTwo} TS01-C2)
        (ref-SWPU:module{SwapperUsageV2} SWPU)
        (ref-SWP:module{SwapperV2} SWP)
        (patron:string KST.ANHD)
        (emma:string KST.EMMA)
        (lumy:string KST.LUMY)
        (coca:string KST.COCA)
        (kiss:string KST.KISS)
        (b-vst:string "BVST-98c486052a51")
        (orbr:string (ref-DALOS::GOV|OUROBOROS|SC_NAME))
        (gas-tanker:string (ref-DALOS::GOV|DALOS|SC_NAME))

    )
    ;(ref-TS01-A::DALOS|A_ToggleGAP true)
    (ref-TS01-C1::DPTF|C_SetFee patron b-vst 250.0)
    (ref-TS01-C1::DPTF|C_ToggleFee patron b-vst true)
    ;(ref-TS01-C1::DPTF|C_ToggleFeeLock patron b-vst true)
    (ref-TS01-C1::DPTF|C_Mint
        patron
        b-vst
        patron
        5000000.0
        true
    )
    (ref-TS01-C1::DPTF|C_Transfer 
        patron 
        b-vst
        patron
        emma
        1000000.0
        false
    )
    (ref-TS01-C1::DPTF|C_Transfer 
        patron 
        b-vst
        emma
        lumy
        400000.0
        false
    )
    (ref-TS01-C1::DPTF|C_DonateFees patron b-vst)
    (ref-TS01-C1::DPTF|C_Transfer 
        patron 
        b-vst
        emma
        lumy
        200000.0
        false
    )
    (ref-TS01-C1::DPTF|C_SetFeeTarget patron b-vst coca)
    (ref-TS01-C1::DPTF|C_Transfer 
        patron 
        b-vst
        emma
        lumy
        100000.0
        false
    )
    (ref-TS01-C2::ORBR|C_WithdrawFees patron b-vst kiss)
    [   
        (format "AH has {} {}" [(ref-DPTF::UR_AccountSupply b-vst patron) b-vst])
        (format "Emma has {} {}" [(ref-DPTF::UR_AccountSupply b-vst emma) b-vst])
        (format "Lumy has {} {}" [(ref-DPTF::UR_AccountSupply b-vst lumy) b-vst])
        (format "Coca has {} {}" [(ref-DPTF::UR_AccountSupply b-vst coca) b-vst])
        (format "Kiss has {} {}" [(ref-DPTF::UR_AccountSupply b-vst kiss) b-vst])
        (format "Gas Tanker has {} {}" [(ref-DPTF::UR_AccountSupply b-vst gas-tanker) b-vst])
        (format "Default Collector has {} {}" [(ref-DPTF::UR_AccountSupply b-vst orbr) b-vst])
    ]
    
)

(print "")
(print "")
(format "<<<<<<<SWP TX 27 - Change Ownership Test Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(print "=======================Swap Tests=================================")
(begin-tx "SWP TX 28 - Migration Test")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AncientHodler", "caps": [] }
        { "key": "PK_Emma", "caps": [] }
        { "key": "PK_AOZ", "caps": [] }
    ]
)

(let
    (
        
        ;
        ;(ref-VST:module{VestingV2} VST)
        ;(emma:string KST.EMMA)
        ;(pool:string "P|OURO-98c486052a51|VST-98c486052a51")
        ;(lp-id "P|OURO-VST|LP-98c486052a51")
        (ref-coin:module{fungible-v2} coin)
        (ref-DALOS:module{OuronetDalosV2} DALOS)
        (ref-DPTF:module{DemiourgosPactTrueFungibleV2} DPTF)
        (ref-DPMF:module{DemiourgosPactMetaFungibleV2} DPMF)
        (ref-TS01-A:module{TalosStageOne_AdminV2} TS01-A)
        (ref-TS01-C1:module{TalosStageOne_ClientOne} TS01-C1)
        (ref-TS01-C2:module{TalosStageOne_ClientTwo} TS01-C2)
        (ref-SWPU:module{SwapperUsageV2} SWPU)
        (ref-SWP:module{SwapperV2} SWP)
        (patron:string KST.ANHD)
        (emma:string KST.EMMA)
        (lumy:string KST.LUMY)
        (coca:string KST.COCA)
        (kiss:string KST.KISS)
        (b-vst:string "BVST-98c486052a51")
        (orbr:string (ref-DALOS::GOV|OUROBOROS|SC_NAME))
        (gas-tanker:string (ref-DALOS::GOV|DALOS|SC_NAME))

        (migration-target:string "k:163320715f95957d1a15ea664fa6bd46f4c59dbb804f793ae93662a4c90b3189")
        (dwk:string "DWK-98c486052a51")
    )
    ;(ref-TS01-A::DALOS|A_ToggleGAP true)
    
    [   
        (format "DWK Supply is {}" [(ref-DPTF::UR_Supply dwk)])
        ;(format "Migration will migrate {} KDA" [(ref-TS01-A::LIQUID|A_MigrateLiquidFunds migration-target)])
        ;(format "Migration address has {} KDA" [(ref-coin::get-balance migration-target)])
    ]
    
)

(print "")
(print "")
(format "<<<<<<<SWP TX 28 Migration Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
;;
;;>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
;;
(print "=======================Swap Tests=================================")
(begin-tx "SWP TX 29 - Treasury Dispo Tests")
(namespace "free")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AncientHodler", "caps": [] }
        { "key": "PK_Emma", "caps": [] }
        { "key": "PK_AOZ", "caps": [] }
        { "key": "PK_DHV", "caps": [] }
    ]
)

(let
    (

        (patron:string KST.ANHD)
        (emma:string KST.EMMA)
        (ref-TS01-A:module{TalosStageOne_AdminV2} TS01-A)
        (ref-DALOS:module{OuronetDalosV2} DALOS)
        (ref-SWPU:module{SwapperUsageV2} SWPU)
        (treasury:string (at 0 (ref-DALOS::UR_DemiurgoiID)))
        (ouro:string (ref-DALOS::UR_OuroborosID))

        ;(ref-VST:module{VestingV2} VST)
        (emma:string KST.EMMA)
        ;(pool:string "P|OURO-98c486052a51|VST-98c486052a51")
        ;(lp-id "P|OURO-VST|LP-98c486052a51")
        ;(ref-coin:module{fungible-v2} coin)
        
        (ref-DPTF:module{DemiourgosPactTrueFungibleV2} DPTF)
        ;(ref-DPMF:module{DemiourgosPactMetaFungibleV2} DPMF)
        (ref-TS01-C1:module{TalosStageOne_ClientOne} TS01-C1)
        ;(ref-TS01-C2:module{TalosStageOne_ClientTwo} TS01-C2)
        ;(ref-SWPU:module{SwapperUsageV2} SWPU)
        ;(ref-SWP:module{SwapperV2} SWP)
        ;(lumy:string KST.LUMY)
        ;(coca:string KST.COCA)
        ;(kiss:string KST.KISS)
        ;(b-vst:string "BVST-98c486052a51")
        ;(orbr:string (ref-DALOS::GOV|OUROBOROS|SC_NAME))
        ;(gas-tanker:string (ref-DALOS::GOV|DALOS|SC_NAME))
        ;(migration-target:string "k:163320715f95957d1a15ea664fa6bd46f4c59dbb804f793ae93662a4c90b3189")
        ;(dwk:string "DWK-98c486052a51")
    )
    (ref-TS01-C1::DPTF|C_Transfer patron ouro treasury emma 250000.0 false)
    (ref-TS01-A::DPTF|A_WipeTreasuryDebtPartial patron 100000.0)
    (ref-TS01-A::DPTF|A_WipeTreasuryDebt patron)
    (ref-TS01-A::DPTF|A_UpdateTreasuryDispoParameters 2 12.0 24.0)
    [   
        (format "Treasury OURO Supply is {}" [(ref-DPTF::UR_AccountSupply ouro treasury)])
        (format "Emma OURO Supply is {}" [(ref-DPTF::UR_AccountSupply ouro emma)])
        (format "Ouro Supply is {}" [(ref-DPTF::UR_Supply ouro)])
        (format "Minimum Treasury Dispo is {}" [(ref-DPTF::URC_TreasuryLowestDispo)])
        (format "Ouro is worth DWK {}" [(ref-SWPU::URC_WorthDWK ouro 1.0)])
    ]
)

(print "")
(print "")
(format "<<<<<<<SWP TX 29 - Treasury Dispo Tests Costs {} KDA GAS>>>>>>>" [(env-gas)])
(print "")
(print "")
(print "===^^^===")
(env-sigs [])
(commit-tx)