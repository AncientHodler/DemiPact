;MODULE LOADINGS
;;==============================================================================
;; PART 01 - Load all Mockup Enviroment Modules
(load "../../../kadena_repl_sandbox-main/kda-env/init.repl")
(load "../Initialise_DALOS.repl")
(load "../AOZ/Init_AOZ.repl")
(print "LOADED ALL ENV MODULES")

;;Entering Namespace Free
(namespace "free")

(begin-tx "Constant Moduel")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(module KC GOVERNANCE
    (defcap GOVERNANCE () true)

    (defconst ANHD "Ѻ.éXødVțrřĄθ7ΛдUŒjeßćιiXTПЗÚĞqŸœÈэαLżØôćmч₱ęãΛě$êůáØCЗшõyĂźςÜãθΘзШË¥şEÈnxΞЗÚÏÛjDVЪжγÏŽнăъçùαìrпцДЖöŃȘâÿřh£1vĎO£κнβдłпČлÿáZiĐą8ÊHÂßĎЩmEBцÄĎвЙßÌ5Ï7ĘŘùrÑckeñëδšПχÌàî")
    (defconst FLRN "Ѻ.ÍăüÙÜЦżΦF₿ÈшÕóñĐĞGюѺλωÇțnθòoйEςк₱0дş3ôPpxŞțqgЖ€šωbэočΞìČ5òżŁdŒИöùЪøŤяжλзÜ2ßżpĄγïčѺöэěτČэεSčDõžЩУЧÀ₳ŚàЪЙĎpЗΣ2ÃлτíČнÙyéÕãďWŹŘĘźσПåbã€éѺι€ΓφŠ₱ŽyWcy5ŘòmČ₿nβÁ¢¥NЙëOι")
    (defconst EMMA "Ѻ.A0ěьπΨтÎșπЦĐđŽ6ЫêÀεÅĐȘдÞЩ4Ł2ďй5žömiτsλÚÇдěÒaV₱ÏûιЩД₳îJÍşыyÜŹżęìvAЙsÄ¢ÿnΦIťQůЮ7ĄвaèďíoáнõÎLJθÆEáПiXÿÒÀĘ14цU1çΞêSťüIψчèι₱ê9ŽчΓüЦrÀÓμĆ99κQťqPÖшŮ1ÈČSĐŁÌбÝàŞbPσŃĎ8ĄW")
    (defconst BYTA "Ѻ.CЭΞŸNGúůρhãmИΘÛ¢₳šШдìAÚwŚGýηЗПAÊУÔȘřŽÍζЗηmΔφDmcдΛъ₳tĂýăŮsПÞ$öœGθeBŽvąαÃfçл¢ĎĆď$şbsЦэΘNÄëÍĂνуãöž¥àZjÆůšÁœôñχŽâЩåτâн4μфAOçĎΓuЗŮnøЙãĚè6Дżîþż$цÑûρψŻïZÉλûæřΨeèÎígςeL")
    (defconst LUMY "Ѻ.œâσzüştŒhłσćØTöõúoвþçЧлρËШđюλ2ÙPeжŘťȚŤtθËûrólþŘß₿øuŁdáNÎČȘřΦĘbχλΩĄ¢ц2ŹθõĐLcÑÁäăå₿ξЭжулxòΘηĂœŞÝUËcω∇ß$ωoñД7θÁяЯéEU¢CЮxÃэJĘčÎΠ£αöŮЖбlćшbăÙЦÎAдŃЭб$ĞцFδŃËúHãjÁÝàĘSt")
    (defconst COCA "Ѻ.áлÜŹZУαŻεvΩ€ÍÉźR5ΠúÉźηüΠÇτOVòÀgZZΠåÈдZëыуЛфЮ13φúνýhMαĄαÖìÍxнпĞjȚ¥бę¥šÔπΓ€Mnøí3ЧθźąйπĆTÌqooŽůŠóŚhřkžφHÿŽBДχpLÉeõxòσûEÜàμΓтÆdôûяàΞRηøćχdîфЩЗьδńŁ$Ü9ř∇ŸŠωVξЦF¢ĆĞÂ₱Ž")
    (defconst KISS "Ѻ.ÔřЦΠúlAŻвnŞÄȘнШĚЖÉřÉĐqлþåΦÉЩвØúÄΣNéSaPpmζżŽtηËJgνπΞ$ЗhêPúÏ£BÀp£β$z7ЯđòÔμЛюGЧĄ7xóЮGЮдYнșШΠŸRA¢śÉ4кAłůaDжp£σÏđχ6ïDжâ5uęΠşÖMþ4¥эăì3cXÛΘИÛźéËBÏžЙŁKjчψĎρЩlźEüśЯŁщbφ2")
    (defconst PLCS "Ѻ.BDțΛZУЩAwÅhУ¥бйeÄGjЯÔIŽ0ΣмωýOÒμψĚяуÿñUĐ€Ú£gâχΓπóÒïЮáпZЧhЫÄIsńËfźÄ1VXУõŘéiàшdĄΞχôCнsÛíÌáàЧßojΛaIλŹЮBøğÔWmòηвá€0ïЗUĞůпøůэóΞÁŘśяŃeÁďfσäKÏßżȚȘÿŒșεúêβÜèkyφΛrβБяK₳ě₱4")
    (defconst NANI "Ѻ.ЮÝžuÂěуşъøŞrΣσQxvЛòÁćÇлςÿŃYóγõыxÁùöÞÁ₳Ю5šШβíюťğÀÎrÿΛůßXЧщŹюДáŻяιËÔŘЬL4₱ĎěJ8ÃHËÏxĆŞÂÜûBcЭШκÙçóьÞÓŮεUIη2ЯąąÙJζÍêíEȘÇșÇOćΞșъÒýĂ₱χÅкGoЗИůω1cþÑŻÁжиáÿιŞŠÓŒлKõÏE₿ÌxYИн")
    (defconst AOZT "Ѻ.ÅτhGźνΣhςвiàÁĘĚДÏWÉΨTěCÃŒnæi9цéŘQí¢лΞÛIчмfÓeżÜýЯàDÖ5αȚÞVđσγ₱0ęЬÔĄsĄLлKùvåH£ΞMFУûÊyđÜqdŽŚЖsĘъsПÂÔØŹÞŮγŚΣЧ6Ïж¢чPyòлБ14ÚęŃĄåîêтηΛbΦđkûÇĂζsБúĎdŸUЛзÙÂÚJηXťćж¥zщòÁŸRĘ")

    (defconst TALOS "Σ.W∇ЦwÏξБØnζΦψÕłěîбηжÛśTã∇țâĆã4ЬĚIŽȘØíÕlÛřбΩцμCšιÄиMkλ€УщшàфGřÞыÎäY8È₳BDÏÚmßOozBτòÊŸŹjПкцğ¥щóиś4h4ÑþююqςA9ÆúÛȚβжéÑψéУoЭπÄЩψďşõшżíZtZuψ4ѺËxЖψУÌбЧλüșěđΔjÈt0ΛŽZSÿΞЩŠ")
    (defconst ATSTK "Σ.ëŤΦșźUÉM89ŹïuÆÒÕ£żíëцΘЯнŹÿxжöwΨ¥Пууhďíπ₱nιrŹÅöыыidõd7ì₿ипΛДĎĎйĄшΛŁPMȘïõμîμŻIцЖljÃαbäЗŸÖéÂЫèpAДuÿPσ8ÎoŃЮнsŤΞìтČ₿Ñ8üĞÕPșчÌșÄG∇MZĂÒЖь₿ØDCПãńΛЬõŞŤЙšÒŸПĘЛΠws9€ΦуêÈŽŻ")
    (defconst VESTG "Σ.şZïζhЛßdяźπПЧDΞZülΦпφßΣитœŸ4ó¥ĘкÌЦ₱₱AÚюłćβρèЬÍŠęgĎwтäъνFf9źdûъtJCλúp₿ÌнË₿₱éåÔŽvCOŠŃpÚKюρЙΣΩìsΞτWpÙŠŹЩпÅθÝØpтŮыØșþшу6GтÃêŮĞбžŠΠŞWĆLτЙđнòZЫÏJÿыжU6ŽкЫVσ€ьqθtÙѺSô€χ")
    (defconst LIQST "Σ.śκν9₿ŻşYЙΣJΘÊO9jпF₿wŻ¥уPэõΣÑïoγΠθßÙzěŃ∇éÖиțșφΦτşэßιBιśiĘîéòюÚY$êFЬŤØ$868дyβT0ςъëÁwRγПŠτËMĚRПMaäЗэiЪiςΨoÞDŮěŠβLé4čØHπĂŃŻЫΣÀmăĐЗżłÄăiĞ₿йÎEσțłGΛЖΔŞx¥ÁiÙNğÅÌlγ¢ĎwдŃ")
    (defconst OURBR "Σ.4M0èÞbøXśαiΠ€NùÇèφqλËãØÓNCнÌπпЬ4γTмыżěуàđЫъмéLUœa₿ĞЬŒѺrËQęíùÅЬ¥τ9£φď6pÙ8ìжôYиșîŻøbğůÞχEшäΞúзêŻöŃЮüŞöućЗßřьяÉżăŹCŸNÅìŸпĐżwüăŞãiÜą1ÃγänğhWg9ĚωG₳R0EùçGΨфχЗLπшhsMτξ")
)

(env-gas)
(commit-tx)

(begin-tx "Test Gas Compression")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AOZ", "caps": [] }
    ]
)

(print "===============================Start AOZ=============================")
(format "AOZ has {} PKOSON, {} EKOSON, {} AKOSON, {} Ignis." 
    [
        (free.BASIS.DPTF-DPMF|UR_AccountSupply "PKOSON-98c486052a51" KC.AOZT true)
        (free.BASIS.DPTF-DPMF|UR_AccountSupply "EKOSON-98c486052a51" KC.AOZT true)
        (free.BASIS.DPTF-DPMF|UR_AccountSupply "AKOSON-98c486052a51" KC.AOZT true)
        (free.BASIS.DPTF-DPMF|UR_AccountSupply "GAS-98c486052a51" KC.AOZT true)
    ]
)
(format "DalosAutostake has {} PKOSON, {} EKOSON, {} AKOSON." 
    [
        (free.BASIS.DPTF-DPMF|UR_AccountSupply "PKOSON-98c486052a51" KC.ATSTK true)
        (free.BASIS.DPTF-DPMF|UR_AccountSupply "EKOSON-98c486052a51" KC.ATSTK true)
        (free.BASIS.DPTF-DPMF|UR_AccountSupply "AKOSON-98c486052a51" KC.ATSTK true)
    ]
)

(format "Reward Tokens for PlebeicStrength are {}" [(free.AUTOSTAKE.ATS|UR_RewardTokenList "PlebeicStrength-98c486052a51")])
(format "Reward Tokens Resident Amounts for PlebeicStrength are {}" [(free.AUTOSTAKE.ATS|UR_RoUAmountList "PlebeicStrength-98c486052a51" true)])
(format "Reward Tokens Unbonding Amounts for PlebeicStrength are {}" [(free.AUTOSTAKE.ATS|UR_RoUAmountList "PlebeicStrength-98c486052a51" false)])
(format "PlebeicStrength is {};"
    [
        (free.AUTOSTAKE.ATS|UC_Index "PlebeicStrength-98c486052a51")
    ]
)
(format "C-RBT for PlebeicStrength is {}" [(free.AUTOSTAKE.ATS|UR_ColdRewardBearingToken "PlebeicStrength-98c486052a51")])
(format "PlebiumDenarius Supply is {}" [(free.BASIS.DPTF-DPMF|UR_Supply "PDKOSON-98c486052a51" true)])
(format "PlebeicStrength RBT-Supply is {}" [(free.AUTOSTAKE.ATS|UCX_PairRBTSupply "PlebeicStrength-98c486052a51")])

        (free.AUTOSTAKE.ATS|C_Coil KC.AOZT KC.AOZT "PlebeicStrength-98c486052a51" "PKOSON-98c486052a51" 100.0)
        (free.AUTOSTAKE.ATS|C_Fuel KC.AOZT KC.AOZT "PlebeicStrength-98c486052a51" "PKOSON-98c486052a51" 50.0)
        (free.AUTOSTAKE.ATS|C_Fuel KC.AOZT KC.AOZT "PlebeicStrength-98c486052a51" "EKOSON-98c486052a51" 40.0)
        (free.AUTOSTAKE.ATS|C_Fuel KC.AOZT KC.AOZT "PlebeicStrength-98c486052a51" "AKOSON-98c486052a51" 80.0)

(format "PlebeicStrength is {};"
    [
        (free.AUTOSTAKE.ATS|UC_Index "PlebeicStrength-98c486052a51")
    ]
)

(format "Cold Recovery is {} and Hot Recovery is {} for PlebeicStrength-98c486052a51"
    [
        (free.AUTOSTAKE.ATS|UR_ToggleColdRecovery "PlebeicStrength-98c486052a51")
        (free.AUTOSTAKE.ATS|UR_ToggleHotRecovery "PlebeicStrength-98c486052a51")
    ]
)

(env-gas)
(commit-tx)

(begin-tx "Test Gas Compression")
(env-gasmodel "table")(env-gaslimit 10000000)(env-gas 0)
(env-sigs 
    [   
        { "key": "PK_AOZ", "caps": [] }
    ]
)

        (print "BEFORE BLOCK===================================")
        ;;AOZET RT Info
        (format "AOZET has has {} PKOSON, {} EKOSON, {} AKOSON." 
            [
                (free.BASIS.DPTF-DPMF|UR_AccountSupply "PKOSON-98c486052a51" KC.AOZT true)
                (free.BASIS.DPTF-DPMF|UR_AccountSupply "EKOSON-98c486052a51" KC.AOZT true)
                (free.BASIS.DPTF-DPMF|UR_AccountSupply "AKOSON-98c486052a51" KC.AOZT true)
            ]
        )
        ;;AOZET RBT Info
        (format "AOZ has {} PlebiumDenarius and {} Denarius Debilis; Time is {}"
            [
                (free.BASIS.DPTF-DPMF|UR_AccountSupply "PDKOSON-98c486052a51" KC.AOZT true)
                (free.BASIS.DPTF-DPMF|UR_AccountSupply "DDKOSON-98c486052a51" KC.AOZT false)
                (at "block-time" (chain-data))
            ]
        )

        ;;INDEX Info
        (print "Plebeic Strength BEFORE HOT Recovery")
        (format "PlebeicStrength is {};"
            [
                (free.AUTOSTAKE.ATS|UC_Index "PlebeicStrength-98c486052a51")
            ]
        )
        (format "Its RBT Supply is {}; C-RBT is {}; Hot-RBT is {}"
            [
                (free.AUTOSTAKE.ATS|UCX_PairRBTSupply "PlebeicStrength-98c486052a51")
                (free.BASIS.DPTF-DPMF|UR_Supply "PDKOSON-98c486052a51" true)
                (free.BASIS.DPTF-DPMF|UR_Supply "DDKOSON-98c486052a51" false)
            ]
        )
        (format "AUTOSTAKE has BEFORE REDEEM {} PKOSON, {} EKOSON, {} AKOSON in Plebeic Strength" 
            [
                (at "resident" (at 0 (free.AUTOSTAKE.ATS|UR_RewardTokens "PlebeicStrength-98c486052a51")))
                (at "resident" (at 1 (free.AUTOSTAKE.ATS|UR_RewardTokens "PlebeicStrength-98c486052a51")))
                (at "resident" (at 2 (free.AUTOSTAKE.ATS|UR_RewardTokens "PlebeicStrength-98c486052a51")))
            ]
        )
        (print "BEFORE BLOCK===================================")
        (print "")
        (print "Function Block ++++++++++++++++++++++++++++++++")
        ;;HOT-Recovery plus Redeem Block
        (free.AUTOSTAKE.ATS|C_HotRecovery KC.AOZT KC.AOZT "PlebeicStrength-98c486052a51" 100.0)

                (format "AOZ has {} PlebiumDenarius and {} Denarius Debilis; Time is {}"
                    [
                        (free.BASIS.DPTF-DPMF|UR_AccountSupply "PDKOSON-98c486052a51" KC.AOZT true)
                        (free.BASIS.DPTF-DPMF|UR_AccountSupply "DDKOSON-98c486052a51" KC.AOZT false)
                        (at "block-time" (chain-data))
                    ]
                )

        (env-chain-data
            {"prev-block-hash": "98c486052a5147fdd30fa43cc6d67e0a4e680c856c37f9157cb788cd67d58006",
            "block-time": (time "2024-10-11T00:00:00Z")}
        )
        (free.OUROBOROS.ATS|C_Redeem KC.AOZT KC.AOZT "DDKOSON-98c486052a51" 1)
        (print "Function Block ++++++++++++++++++++++++++++++++")
        (print "")
        (print "AFTER BLOCK====================================")
        ;;AOZET RT Info
        (format "AOZET has has {} PKOSON, {} EKOSON, {} AKOSON." 
            [
                (free.BASIS.DPTF-DPMF|UR_AccountSupply "PKOSON-98c486052a51" KC.AOZT true)
                (free.BASIS.DPTF-DPMF|UR_AccountSupply "EKOSON-98c486052a51" KC.AOZT true)
                (free.BASIS.DPTF-DPMF|UR_AccountSupply "AKOSON-98c486052a51" KC.AOZT true)
            ]
        )
        ;;AOZET RBT Info
        (format "AOZ has {} PlebiumDenarius and {} Denarius Debilis; Time is {}"
            [
                (free.BASIS.DPTF-DPMF|UR_AccountSupply "PDKOSON-98c486052a51" KC.AOZT true)
                (free.BASIS.DPTF-DPMF|UR_AccountSupply "DDKOSON-98c486052a51" KC.AOZT false)
                (at "block-time" (chain-data))
            ]
        )

        ;;INDEX Info
        (print "Plebeic Strength BEFORE HOT Recovery")
        (format "PlebeicStrength is {};"
            [
                (free.AUTOSTAKE.ATS|UC_Index "PlebeicStrength-98c486052a51")
        ]
        )
        (format "Its RBT Supply is {}; C-RBT is {}; Hot-RBT is {}"
            [
                (free.AUTOSTAKE.ATS|UCX_PairRBTSupply "PlebeicStrength-98c486052a51")
                (free.BASIS.DPTF-DPMF|UR_Supply "PDKOSON-98c486052a51" true)
                (free.BASIS.DPTF-DPMF|UR_Supply "DDKOSON-98c486052a51" false)
            ]
        )
        (format "AUTOSTAKE has AFTER REDEEM {} PKOSON, {} EKOSON, {} AKOSON in Plebeic Strength" 
            [
                (at "resident" (at 0 (free.AUTOSTAKE.ATS|UR_RewardTokens "PlebeicStrength-98c486052a51")))
                (at "resident" (at 1 (free.AUTOSTAKE.ATS|UR_RewardTokens "PlebeicStrength-98c486052a51")))
                (at "resident" (at 2 (free.AUTOSTAKE.ATS|UR_RewardTokens "PlebeicStrength-98c486052a51")))
            ]
        )
        (print "AFTER BLOCK====================================")
            

(env-gas)
(commit-tx)